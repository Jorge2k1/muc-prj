/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={7:()=>{$(document).ready((function(){$(".menu a").click((function(e){e.preventDefault();var t=$(this.hash);t.length&&$("html, body").animate({scrollTop:t.offset().top},1e3)}))})),$(document).ready((function(){$(window).scroll((function(){$(this).scrollTop()>100?($(".head").addClass("scrolled"),$(".menu").addClass("scrolled"),$(".global").addClass("scrolled")):($(".head").removeClass("scrolled"),$(".menu").removeClass("scrolled"),$(".global").removeClass("scrolled"))}))})),$(document).ready((function(){$(window).scroll((function(){var e=$(this).scrollTop(),t=$(window).height(),n=100-e/t*62,i=Math.max(0,38-e/t*38);n=Math.max(n,0),i=Math.min(i,38),$(".global").css("background-image","linear-gradient(to bottom, black ".concat(i,"%,  #013220 ").concat(n,"%)")),n<=19?$(".front").addClass("white-text"):$(".front").removeClass("white-text")}))}))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";n(7);const e=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},t={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=r>>2,l=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[u],n[l],n[h],n[d])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const s=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==s||null==o||null==a||null==c)throw new i;const u=s<<2|o>>4;if(r.push(u),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r=function(n){return function(n){const i=e(n);return t.encodeByteArray(i,!0)}(n).replace(/\./g,"")},s=function(e){try{return t.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&s(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},a=e=>{var t,n;return null===(n=null===(t=o())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},c=()=>{var e;return null===(e=o())||void 0===e?void 0:e.config},u=e=>{var t;return null===(t=o())||void 0===t?void 0:t[`_${e}`]};class l{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function d(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function f(){try{return"object"==typeof indexedDB}catch(e){return!1}}function p(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(y,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new g(i,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(w(n)&&w(s)){if(!v(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function w(e){return null!==e&&"object"==typeof e}function b(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function I(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function E(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class _{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=T),void 0===i.error&&(i.error=T),void 0===i.complete&&(i.complete=T);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}const S=1e3,C=2,A=144e5,k=.5;function N(e,t=S,n=C){const i=t*Math.pow(n,e),r=Math.round(k*i*(Math.random()-.5)*2);return Math.min(A,i+r)}function D(e){return e&&e._delegate?e._delegate:e}class R{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const O="[DEFAULT]";class P{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new l;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:O})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=O){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=O){return this.instances.has(e)}getOptions(e=O){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===O?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=O){return this.component?this.component.multipleInstances?e:O:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class L{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new P(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const M=[];var x;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(x||(x={}));const U={debug:x.DEBUG,verbose:x.VERBOSE,info:x.INFO,warn:x.WARN,error:x.ERROR,silent:x.SILENT},F=x.INFO,V={[x.DEBUG]:"log",[x.VERBOSE]:"log",[x.INFO]:"info",[x.WARN]:"warn",[x.ERROR]:"error"},j=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=V[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class B{constructor(e){this.name=e,this._logLevel=F,this._logHandler=j,this._userLogHandler=null,M.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in x))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?U[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,x.DEBUG,...e),this._logHandler(this,x.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,x.VERBOSE,...e),this._logHandler(this,x.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,x.INFO,...e),this._logHandler(this,x.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,x.WARN,...e),this._logHandler(this,x.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,x.ERROR,...e),this._logHandler(this,x.ERROR,...e)}}const $=(e,t)=>t.some((t=>e instanceof t));let z,q;const H=new WeakMap,K=new WeakMap,G=new WeakMap,W=new WeakMap,Q=new WeakMap;let J={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return K.get(e);if("objectStoreNames"===t)return e.objectStoreNames||G.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Y(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function X(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(q||(q=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Z(this),e),Y(H.get(this))}:function(...e){return Y(t.apply(Z(this),e))}:function(e,...n){const i=t.call(Z(this),e,...n);return G.set(i,e.sort?e.sort():[e]),Y(i)}:(e instanceof IDBTransaction&&function(e){if(K.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));K.set(e,t)}(e),$(e,z||(z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,J):e);var t}function Y(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Y(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&H.set(t,e)})).catch((()=>{})),Q.set(t,e),t}(e);if(W.has(e))return W.get(e);const t=X(e);return t!==e&&(W.set(e,t),Q.set(t,e)),t}const Z=e=>Q.get(e);function ee(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=Y(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(Y(o.result),e.oldVersion,e.newVersion,Y(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const te=["get","getKey","getAll","getAllKeys","count"],ne=["put","add","delete","clear"],ie=new Map;function re(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ie.get(t))return ie.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=ne.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!te.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return ie.set(t,s),s}var se;se=J,J={...se,get:(e,t,n)=>re(e,t)||se.get(e,t,n),has:(e,t)=>!!re(e,t)||se.has(e,t)};class oe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ae="@firebase/app",ce="0.9.28",ue=new B("@firebase/app"),le="[DEFAULT]",he={[ae]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},de=new Map,fe=new Map;function pe(e,t){try{e.container.addComponent(t)}catch(n){ue.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ge(e){const t=e.name;if(fe.has(t))return ue.debug(`There were multiple attempts to register component ${t}.`),!1;fe.set(t,e);for(const t of de.values())pe(t,e);return!0}function me(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ye=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ve{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new R("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ye.create("app-deleted",{appName:this._name})}}const we="10.8.1";function be(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:le,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ye.create("bad-app-name",{appName:String(r)});if(n||(n=c()),!n)throw ye.create("no-options");const s=de.get(r);if(s){if(v(n,s.options)&&v(i,s.config))return s;throw ye.create("duplicate-app",{appName:r})}const o=new L(r);for(const e of fe.values())o.addComponent(e);const a=new ve(n,i,o);return de.set(r,a),a}function Ie(e=le){const t=de.get(e);if(!t&&e===le&&c())return be();if(!t)throw ye.create("no-app",{appName:e});return t}function Ee(e,t,n){var i;let r=null!==(i=he[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ue.warn(e.join(" "))}ge(new R(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const _e="firebase-heartbeat-database",Te=1,Se="firebase-heartbeat-store";let Ce=null;function Ae(){return Ce||(Ce=ee(_e,Te,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Se)}catch(e){console.warn(e)}}}).catch((e=>{throw ye.create("idb-open",{originalErrorMessage:e.message})}))),Ce}async function ke(e,t){try{const n=(await Ae()).transaction(Se,"readwrite"),i=n.objectStore(Se);await i.put(t,Ne(e)),await n.done}catch(e){if(e instanceof g)ue.warn(e.message);else{const t=ye.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}function Ne(e){return`${e.name}!${e.options.appId}`}class De{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Oe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Re();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Re(),{heartbeatsToSend:n,unsentEntries:i}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Pe(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Pe(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=r(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Re(){return(new Date).toISOString().substring(0,10)}class Oe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!f()&&p().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Ae()).transaction(Se),n=await t.objectStore(Se).get(Ne(e));return await t.done,n}catch(e){if(e instanceof g)ue.warn(e.message);else{const t=ye.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Pe(e){return r(JSON.stringify({version:2,heartbeats:e})).length}ge(new R("platform-logger",(e=>new oe(e)),"PRIVATE")),ge(new R("heartbeat",(e=>new De(e)),"PRIVATE")),Ee(ae,ce,""),Ee(ae,ce,"esm2017"),Ee("fire-js",""),Ee("firebase","10.8.1","app");const Le="@firebase/installations",Me="0.6.5",xe=1e4,Ue=`w:${Me}`,Fe="FIS_v2",Ve="https://firebaseinstallations.googleapis.com/v1",je=36e5,Be=new m("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function $e(e){return e instanceof g&&e.code.includes("request-failed")}function ze({projectId:e}){return`${Ve}/projects/${e}/installations`}function qe(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function He(e,t){const n=(await t.json()).error;return Be.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Ke({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Ge(e){const t=await e();return t.status>=500&&t.status<600?e():t}function We(e){return new Promise((t=>{setTimeout(t,e)}))}const Qe=/^[cdef][\w-]{21}$/,Je="";function Xe(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return Qe.test(t)?t:Je}catch(e){return Je}}function Ye(e){return`${e.appName}!${e.appId}`}const Ze=new Map;function et(e,t){const n=Ye(e);tt(n,t),function(e,t){const n=(!nt&&"BroadcastChannel"in self&&(nt=new BroadcastChannel("[Firebase] FID Change"),nt.onmessage=e=>{tt(e.data.key,e.data.fid)}),nt);n&&n.postMessage({key:e,fid:t}),0===Ze.size&&nt&&(nt.close(),nt=null)}(n,t)}function tt(e,t){const n=Ze.get(e);if(n)for(const e of n)e(t)}let nt=null;const it="firebase-installations-database",rt=1,st="firebase-installations-store";let ot=null;function at(){return ot||(ot=ee(it,rt,{upgrade:(e,t)=>{0===t&&e.createObjectStore(st)}})),ot}async function ct(e,t){const n=Ye(e),i=(await at()).transaction(st,"readwrite"),r=i.objectStore(st),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||et(e,t.fid),t}async function ut(e){const t=Ye(e),n=(await at()).transaction(st,"readwrite");await n.objectStore(st).delete(t),await n.done}async function lt(e,t){const n=Ye(e),i=(await at()).transaction(st,"readwrite"),r=i.objectStore(st),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||et(e,o.fid),o}async function ht(e){let t;const n=await lt(e.appConfig,(n=>{const i=function(e){return pt(e||{fid:Xe(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Be.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=ze(e),r=Ke(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:Fe,appId:e.appId,sdkVersion:Ue},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Ge((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:qe(e.authToken)}}throw await He("Create Installation",c)}(e,t);return ct(e.appConfig,n)}catch(n){throw $e(n)&&409===n.customData.serverCode?await ut(e.appConfig):await ct(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:dt(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return n.fid===Je?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function dt(e){let t=await ft(e.appConfig);for(;1===t.registrationStatus;)await We(100),t=await ft(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await ht(e);return n||t}return t}function ft(e){return lt(e,(e=>{if(!e)throw Be.create("installation-not-found");return pt(e)}))}function pt(e){return 1===(t=e).registrationStatus&&t.registrationTime+xe<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function gt({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${ze(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=Ke(e);return n.append("Authorization",function(e){return`${Fe} ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ue,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Ge((()=>fetch(i,a)));if(c.ok)return qe(await c.json());throw await He("Generate Auth Token",c)}async function mt(e,t=!1){let n;const i=await lt(e.appConfig,(i=>{if(!vt(i))throw Be.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+je}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await yt(e.appConfig);for(;1===n.authToken.requestStatus;)await We(100),n=await yt(e.appConfig);const i=n.authToken;return 0===i.requestStatus?mt(e,t):i}(e,t),i;{if(!navigator.onLine)throw Be.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await gt(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await ct(e.appConfig,i),n}catch(n){if(!$e(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ct(e.appConfig,n)}else await ut(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function yt(e){return lt(e,(e=>{if(!vt(e))throw Be.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+xe<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function vt(e){return void 0!==e&&2===e.registrationStatus}function wt(e){return Be.create("missing-app-config-values",{valueName:e})}const bt="installations";ge(new R(bt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw wt("App Configuration");if(!e.name)throw wt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw wt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:me(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ge(new R("installations-internal",(e=>{const t=me(e.getProvider("app").getImmediate(),bt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await ht(t);return i?i.catch(console.error):mt(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await ht(e);t&&await t}(n),(await mt(n,t)).token}(t,e)}}),"PRIVATE")),Ee(Le,Me),Ee(Le,Me,"esm2017");const It="analytics",Et="firebase_id",_t="origin",Tt=6e4,St="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ct="https://www.googletagmanager.com/gtag/js",At=new B("@firebase/analytics"),kt=new m("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Nt(e){if(!e.startsWith(Ct)){const t=kt.create("invalid-gtag-resource",{gtagURL:e});return At.warn(t.message),""}return e}function Dt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Rt=30,Ot=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Pt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Lt(e,t=Ot,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw kt.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw kt.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new xt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:Tt),Mt({appId:i,apiKey:r,measurementId:s},o,a,t)}async function Mt(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=Ot){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(kt.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(a)return At.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:Pt(i)},s=St.replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw kt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof g&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(r.deleteThrottleMetadata(o),a)return At.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const u=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?N(n,r.intervalMillis,Rt):N(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(o,l),At.debug(`Calling attemptFetch again in ${u} millis`),Mt(e,l,i,r)}}class xt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Ut,Ft;async function Vt(e,t,n,i,r,s,o){var a;const c=Lt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&At.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>At.error(e))),t.push(c);const u=async function(){if(!f())return At.warn(kt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await p()}catch(e){return At.warn(kt.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Ct)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Nt}),i=document.createElement("script"),r=`${Ct}?l=${e}&id=${t}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,l.measurementId),Ft&&(r("consent","default",Ft),Ft=void 0),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[_t]="firebase",d.update=!0,null!=h&&(d[Et]=h),r("config",l.measurementId,d),Ut&&(r("set",Ut),Ut=void 0),l.measurementId}class jt{constructor(e){this.app=e}_delete(){return delete Bt[this.app.options.appId],Promise.resolve()}}let Bt={},$t=[];const zt={};let qt,Ht,Kt="dataLayer",Gt=!1;function Wt(e,t,n){!function(){const e=[];if(d()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=kt.create("invalid-analytics-context",{errorInfo:t});At.warn(n.message)}}();const i=e.options.appId;if(!i)throw kt.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw kt.create("no-api-key");At.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Bt[i])throw kt.create("already-exists",{id:i});if(!Gt){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Kt);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(e,t,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await Dt(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){At.error(e)}}(e,t,n,i,r)}else if("config"===r){const[r,o]=s;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await Dt(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){At.error(e)}e("config",r,s)}(e,t,n,i,r,o)}else if("consent"===r){const[t]=s;e("consent","update",t)}else if("get"===r){const[t,n,i]=s;e("get",t,n,i)}else if("set"===r){const[t]=s;e("set",t)}else e(r,...s)}catch(e){At.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(Bt,$t,zt,Kt,"gtag");Ht=e,qt=t,Gt=!0}return Bt[i]=Vt(e,$t,zt,t,qt,Kt,n),new jt(e)}const Qt="@firebase/analytics",Jt="0.10.1";function Xt(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}ge(new R(It,((e,{options:t})=>Wt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ge(new R("analytics-internal",(function(e){try{const t=e.getProvider(It).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=D(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Ht,Bt[e.app.options.appId],t,n,i).catch((e=>At.error(e)))}(t,e,n,i)}}catch(e){throw kt.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ee(Qt,Jt),Ee(Qt,Jt,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Yt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Zt=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),en=new B("@firebase/auth");function tn(e,...t){en.logLevel<=x.ERROR&&en.error(`Auth (${we}): ${e}`,...t)}function nn(e,...t){throw sn(e,...t)}function rn(e,...t){return sn(e,...t)}function sn(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Zt.create(e,...t)}function on(e,t,...n){if(!e)throw sn(t,...n)}function an(e){const t="INTERNAL ASSERTION FAILED: "+e;throw tn(t),new Error(t)}function cn(e,t){e||an(t)}function un(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function ln(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class hn{constructor(e,t){this.shortDelay=e,this.longDelay=t,cn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===ln()||"https:"===ln()||d()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function dn(e,t){cn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class fn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void an("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void an("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void an("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const pn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},gn=new hn(3e4,6e4);function mn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function yn(e,t,n,i,r={}){return vn(e,r,(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=b(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),fn.fetch()(bn(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function vn(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},pn),t);try{const t=new En(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw _n(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw _n(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw _n(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw _n(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},Yt()),{[t]:n});return new m("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);nn(e,a)}}catch(t){if(t instanceof g)throw t;nn(e,"network-request-failed",{message:String(t)})}}async function wn(e,t,n,i,r={}){const s=await yn(e,t,n,i,r);return"mfaPendingCredential"in s&&nn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function bn(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?dn(e.config,r):`${e.config.apiScheme}://${r}`}function In(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class En{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(rn(this.auth,"network-request-failed"))),gn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function _n(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=rn(e,t,i);return r.customData._tokenResponse=n,r}function Tn(e){return void 0!==e&&void 0!==e.enterprise}class Sn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return In(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}function Cn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function An(e){return 1e3*Number(e)}function kn(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return tn("JWT malformed, contained fewer than 3 sections"),null;try{const e=s(n);return e?JSON.parse(e):(tn("Failed to decode base64 JWT payload"),null)}catch(e){return tn("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function Nn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Dn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Rn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cn(this.lastLoginAt),this.creationTime=Cn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function On(e){var t;const n=e.auth,i=await e.getIdToken(),r=await Nn(e,async function(e,t){return yn(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));on(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Xt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Rn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class Pn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){on(e.idToken,"internal-error"),on(void 0!==e.idToken,"internal-error"),on(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=kn(e);return on(t,"internal-error"),on(void 0!==t.exp,"internal-error"),on(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return on(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await vn(e,{},(async()=>{const n=b({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=bn(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",fn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new Pn;return n&&(on("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(on("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(on("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pn,this.toJSON())}_performRefresh(){return an("not implemented")}}function Ln(e,t){on("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Mn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Xt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Rn(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Nn(this,this.stsTokenManager.getToken(this.auth,e));return on(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=D(e),i=await n.getIdToken(t),r=kn(i);on(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Cn(An(r.auth_time)),issuedAtTime:Cn(An(r.iat)),expirationTime:Cn(An(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=D(e);await On(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(on(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Mn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){on(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await On(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Nn(this,async function(e,t){return yn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:I,stsTokenManager:E}=t;on(v&&E,e,"internal-error");const _=Pn.fromJSON(this.name,E);on("string"==typeof v,e,"internal-error"),Ln(l,e.name),Ln(h,e.name),on("boolean"==typeof w,e,"internal-error"),on("boolean"==typeof b,e,"internal-error"),Ln(d,e.name),Ln(f,e.name),Ln(p,e.name),Ln(g,e.name),Ln(m,e.name),Ln(y,e.name);const T=new Mn({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:m,lastLoginAt:y});return I&&Array.isArray(I)&&(T.providerData=I.map((e=>Object.assign({},e)))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t,n=!1){const i=new Pn;i.updateFromServerResponse(t);const r=new Mn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await On(r),r}}const xn=new Map;function Un(e){cn(e instanceof Function,"Expected a class definition");let t=xn.get(e);return t?(cn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,xn.set(e,t),t)}class Fn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Fn.type="NONE";const Vn=Fn;function jn(e,t,n){return`firebase:${e}:${t}:${n}`}class Bn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=jn(this.userKey,i.apiKey,r),this.fullPersistenceKey=jn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Mn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Bn(Un(Vn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Un(Vn);const s=jn(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=Mn._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new Bn(r,e,n)):new Bn(r,e,n)}}function $n(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Kn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(zn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Wn(t))return"Blackberry";if(Qn(t))return"Webos";if(qn(t))return"Safari";if((t.includes("chrome/")||Hn(t))&&!t.includes("edge/"))return"Chrome";if(Gn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function zn(e=h()){return/firefox\//i.test(e)}function qn(e=h()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Hn(e=h()){return/crios\//i.test(e)}function Kn(e=h()){return/iemobile/i.test(e)}function Gn(e=h()){return/android/i.test(e)}function Wn(e=h()){return/blackberry/i.test(e)}function Qn(e=h()){return/webos/i.test(e)}function Jn(e=h()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Xn(e=h()){return Jn(e)||Gn(e)||Qn(e)||Wn(e)||/windows phone/i.test(e)||Kn(e)}function Yn(e,t=[]){let n;switch(e){case"Browser":n=$n(h());break;case"Worker":n=`${$n(h())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${we}/${i}`}class Zn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class ei{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class ti{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ii(this),this.idTokenSubscription=new ii(this),this.beforeStateQueue=new Zn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Zt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Un(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Bn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return on(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await On(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?D(e):null;return t&&on(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&on(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Un(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return yn(e,"GET","/v2/passwordPolicy",mn(e,t))}(this),t=new ei(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new m("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return yn(e,"POST","/v2/accounts:revokeToken",mn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Un(e)||this._popupRedirectResolver;on(t,this,"argument-error"),this.redirectPersistenceManager=await Bn.create(this,[Un(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(on(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return on(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Yn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){en.logLevel<=x.WARN&&en.warn(`Auth (${we}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ni(e){return D(e)}class ii{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new _(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return on(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ri={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function si(e){return ri.loadJS(e)}function oi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class ai{constructor(e){this.type="recaptcha-enterprise",this.auth=ni(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;Tn(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return yn(e,"GET","/v2/recaptchaConfig",mn(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Sn(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&Tn(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=ri.recaptchaEnterpriseScript;0!==t.length&&(t+=r),si(t).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function ci(e,t,n,i=!1){const r=new ai(e);let s;try{s=await r.verify(n)}catch(e){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ui(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await ci(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await ci(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)}))}function li(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function hi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class di{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return an("not implemented")}_getIdTokenResponse(e){return an("not implemented")}_linkToIdToken(e,t){return an("not implemented")}_getReauthenticationResolver(e){return an("not implemented")}}async function fi(e,t){return yn(e,"POST","/v1/accounts:signUp",t)}async function pi(e,t){return wn(e,"POST","/v1/accounts:signInWithPassword",mn(e,t))}class gi extends di{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new gi(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new gi(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ui(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",pi);case"emailLink":return async function(e,t){return wn(e,"POST","/v1/accounts:signInWithEmailLink",mn(e,t))}(e,{email:this._email,oobCode:this._password});default:nn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ui(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",fi);case"emailLink":return async function(e,t){return wn(e,"POST","/v1/accounts:signInWithEmailLink",mn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:nn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function mi(e,t){return wn(e,"POST","/v1/accounts:signInWithIdp",mn(e,t))}class yi extends di{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):nn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Xt(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new yi(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return mi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=b(t)}return e}}const vi={USER_NOT_FOUND:"user-not-found"};class wi extends di{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new wi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new wi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return wn(e,"POST","/v1/accounts:signInWithPhoneNumber",mn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await wn(e,"POST","/v1/accounts:signInWithPhoneNumber",mn(e,t));if(n.temporaryProof)throw _n(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return wn(e,"POST","/v1/accounts:signInWithPhoneNumber",mn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),vi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new wi({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class bi{constructor(e){var t,n,i,r,s,o;const a=I(E(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);on(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=I(E(e)).link,n=t?I(E(t)).deep_link_id:null,i=I(E(e)).deep_link_id;return(i?I(E(i)).link:null)||i||n||t||e}(e);try{return new bi(t)}catch(e){return null}}}class Ii{constructor(){this.providerId=Ii.PROVIDER_ID}static credential(e,t){return gi._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=bi.parseLink(t);return on(n,"argument-error"),gi._fromEmailAndCode(e,n.code,n.tenantId)}}Ii.PROVIDER_ID="password",Ii.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ii.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ei{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class _i extends Ei{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ti extends _i{constructor(){super("facebook.com")}static credential(e){return yi._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ti.credential(e.oauthAccessToken)}catch(e){return null}}}Ti.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ti.PROVIDER_ID="facebook.com";class Si extends _i{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yi._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Si.credential(t,n)}catch(e){return null}}}Si.GOOGLE_SIGN_IN_METHOD="google.com",Si.PROVIDER_ID="google.com";class Ci extends _i{constructor(){super("github.com")}static credential(e){return yi._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch(e){return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com",Ci.PROVIDER_ID="github.com";class Ai extends _i{constructor(){super("twitter.com")}static credential(e,t){return yi._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ai.credential(t,n)}catch(e){return null}}}async function ki(e,t){return wn(e,"POST","/v1/accounts:signUp",mn(e,t))}Ai.TWITTER_SIGN_IN_METHOD="twitter.com",Ai.PROVIDER_ID="twitter.com";class Ni{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await Mn._fromIdTokenResponse(e,n,i),s=Di(n);return new Ni({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Di(n);return new Ni({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Di(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ri extends g{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ri.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Ri(e,t,n,i)}}function Oi(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ri._fromErrorAndOperation(e,n,t,i);throw n}))}async function Pi(e,t,n=!1){const i="signIn",r=await Oi(e,i,t),s=await Ni._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}async function Li(e){const t=ni(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}new WeakMap;const Mi="__sak";class xi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mi,"1"),this.storage.removeItem(Mi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ui extends xi{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=h();return qn(e)||Jn(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Xn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=h();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ui.type="LOCAL";const Fi=Ui;class Vi extends xi{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Vi.type="SESSION";const ji=Vi;class Bi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Bi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function $i(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Bi.receivers=[];class zi{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=$i("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function qi(){return window}function Hi(){return void 0!==qi().WorkerGlobalScope&&"function"==typeof qi().importScripts}const Ki="firebaseLocalStorageDb",Gi="firebaseLocalStorage",Wi="fbase_key";class Qi{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Ji(e,t){return e.transaction([Gi],t?"readwrite":"readonly").objectStore(Gi)}function Xi(){const e=indexedDB.open(Ki,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Gi,{keyPath:Wi})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Gi)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ki);return new Qi(e).toPromise()}(),t(await Xi()))}))}))}async function Yi(e,t,n){const i=Ji(e,!0).put({[Wi]:t,value:n});return new Qi(i).toPromise()}function Zi(e,t){const n=Ji(e,!0).delete(t);return new Qi(n).toPromise()}class er{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Xi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bi._getInstance(Hi()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new zi(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xi();return await Yi(e,Mi,"1"),await Zi(e,Mi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Yi(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Ji(e,!1).get(t),i=await new Qi(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Zi(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Ji(e,!1).getAll();return new Qi(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}er.type="LOCAL";const tr=er;oi("rcb"),new hn(3e4,6e4);class nr{constructor(e){this.providerId=nr.PROVIDER_ID,this.auth=ni(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(on("string"==typeof r,e,"argument-error"),on("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){on("enroll"===t.type,e,"internal-error");const n=await function(e,t){return yn(e,"POST","/v2/accounts/mfaEnrollment:start",mn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{on("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;on(n,e,"missing-multi-factor-info");const o=await function(e,t){return yn(e,"POST","/v2/accounts/mfaSignIn:start",mn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return yn(e,"POST","/v1/accounts:sendVerificationCode",mn(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,D(t))}static credential(e,t){return wi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return nr.credentialFromTaggedObject(t)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?wi._fromTokenResponse(t,n):null}}nr.PROVIDER_ID="phone",nr.PHONE_SIGN_IN_METHOD="phone";class ir extends di{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rr(e){return Pi(e.auth,new ir(e),e.bypassAuthState)}function sr(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const s=await Nn(e,Oi(i,r,t,e),n);on(s.idToken,i,"internal-error");const o=kn(s.idToken);on(o,i,"internal-error");const{sub:a}=o;return on(e.uid===a,i,"user-mismatch"),Ni._forOperation(e,r,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&nn(i,"user-mismatch"),e}}(n,new ir(e),e.bypassAuthState)}async function or(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),async function(e,t,n=!1){const i=await Nn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ni._forOperation(e,"link",i)}(n,new ir(e),e.bypassAuthState)}class ar{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rr;case"linkViaPopup":case"linkViaRedirect":return or;case"reauthViaPopup":case"reauthViaRedirect":return sr;default:nn(this.auth,"internal-error")}}resolve(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cr=new hn(2e3,1e4);class ur extends ar{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,ur.currentPopupAction&&ur.currentPopupAction.cancel(),ur.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return on(e,this.auth,"internal-error"),e}async onExecution(){cn(1===this.filter.length,"Popup operations only handle one event");const e=$i();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(rn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(rn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ur.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(rn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,cr.get())};e()}}ur.currentPopupAction=null;const lr="pendingRedirect",hr=new Map;class dr extends ar{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=hr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return jn(lr,e.config.apiKey,e.name)}(t),i=function(e){return Un(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}hr.set(this.auth._key(),e)}return this.bypassAuthState||hr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function fr(e,t){hr.set(e._key(),t)}async function pr(e,t,n=!1){const i=ni(e),r=function(e,t){return t?Un(t):(on(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new dr(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class gr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!yr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(rn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mr(e))}saveEventToCache(e){this.cachedEventUids.add(mr(e)),this.lastProcessedEventTime=Date.now()}}function mr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function yr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const vr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wr=/^https?/;function br(e){const t=un(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!wr.test(n))return!1;if(vr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Ir=new hn(3e4,6e4);function Er(){const e=qi().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function _r(e){return new Promise(((t,n)=>{var i,r,s;function o(){Er(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Er(),n(rn(e,"network-request-failed"))},timeout:Ir.get()})}if(null===(r=null===(i=qi().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=qi().gapi)||void 0===s?void 0:s.load)){const t=oi("iframefcb");return qi()[t]=()=>{gapi.load?o():n(rn(e,"network-request-failed"))},si(`${ri.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Tr=null,e}))}let Tr=null;const Sr=new hn(5e3,15e3),Cr="__/auth/iframe",Ar="emulator/auth/iframe",kr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Nr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dr(e){const t=e.config;on(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?dn(t,Ar):`https://${e.config.authDomain}/${Cr}`,i={apiKey:t.apiKey,appName:e.name,v:we},r=Nr.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${b(i).slice(1)}`}const Rr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Or{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const Pr=encodeURIComponent("fac");async function Lr(e,t,n,i,r,s){on(e.config.authDomain,e,"auth-domain-config-required"),on(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:we,eventId:r};if(t instanceof Ei){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof _i){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${Pr}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?dn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${b(a).slice(1)}${u}`}const Mr="webStorageSupport",xr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ji,this._completeRedirectFn=pr,this._overrideRedirectResult=fr}async _openPopup(e,t,n,i){var r;return cn(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Rr),{width:i.toString(),height:r.toString(),top:s,left:o}),u=h().toLowerCase();n&&(a=Hn(u)?"_blank":n),zn(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=h()){var t;return Jn(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new Or(null);const d=window.open(t||"",a,l);on(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Or(d)}(e,await Lr(e,t,n,un(),i),$i())}async _openRedirect(e,t,n,i){return await this._originValidation(e),r=await Lr(e,t,n,un(),i),qi().location.href=r,new Promise((()=>{}));var r}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(cn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return Tr=Tr||_r(e),Tr}(e),n=qi().gapi;return on(n,e,"internal-error"),t.open({where:document.body,url:Dr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kr,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=rn(e,"network-request-failed"),s=qi().setTimeout((()=>{i(r)}),Sr.get());function o(){qi().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new gr(e);return t.register("authEvent",(t=>(on(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mr,{type:Mr},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Mr];void 0!==r&&t(!!r),nn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return yn(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(br(e))return}catch(e){}nn(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Xn()||qn()||Jn()}};var Ur="@firebase/auth",Fr="1.6.1";class Vr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){on(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const jr=u("authIdTokenMaxAge")||300;let Br=null;var $r;!function(e){ri=e}({loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=rn("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),$r="Browser",ge(new R("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;on(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:$r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yn($r)},c=new ti(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Un);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ge(new R("auth-internal",(e=>(e=>new Vr(e))(ni(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ee(Ur,Fr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}($r)),Ee(Ur,Fr,"esm2017");var zr,qr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Hr={},Kr=Kr||{},Gr=qr||self;function Wr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Qr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Jr="closure_uid_"+(1e9*Math.random()>>>0),Xr=0;function Yr(e,t,n){return e.call.apply(e.bind,arguments)}function Zr(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function es(e,t,n){return(es=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Yr:Zr).apply(null,arguments)}function ts(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function ns(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function is(){this.s=this.s,this.o=this.o}is.prototype.s=!1,is.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Jr)&&e[Jr]||(e[Jr]=++Xr))},is.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const rs=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function ss(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function os(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(Wr(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function as(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}as.prototype.h=function(){this.defaultPrevented=!0};var cs=function(){if(!Gr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};Gr.addEventListener("test",e,t),Gr.removeEventListener("test",e,t)}catch(e){}return e}();function us(e){return/^[\s\xa0]*$/.test(e)}function ls(){var e=Gr.navigator;return e&&(e=e.userAgent)?e:""}function hs(e){return-1!=ls().indexOf(e)}function ds(e){return ds[" "](e),e}ds[" "]=function(){};var fs,ps,gs,ms=hs("Opera"),ys=hs("Trident")||hs("MSIE"),vs=hs("Edge"),ws=vs||ys,bs=hs("Gecko")&&!(-1!=ls().toLowerCase().indexOf("webkit")&&!hs("Edge"))&&!(hs("Trident")||hs("MSIE"))&&!hs("Edge"),Is=-1!=ls().toLowerCase().indexOf("webkit")&&!hs("Edge");function Es(){var e=Gr.document;return e?e.documentMode:void 0}e:{var _s="",Ts=(ps=ls(),bs?/rv:([^\);]+)(\)|;)/.exec(ps):vs?/Edge\/([\d\.]+)/.exec(ps):ys?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ps):Is?/WebKit\/(\S+)/.exec(ps):ms?/(?:Version)[ \/]?(\S+)/.exec(ps):void 0);if(Ts&&(_s=Ts?Ts[1]:""),ys){var Ss=Es();if(null!=Ss&&Ss>parseFloat(_s)){fs=String(Ss);break e}}fs=_s}Gr.document&&ys?gs=Es()||parseInt(fs,10)||void 0:gs=void 0;var Cs=gs;function As(e,t){if(as.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(bs){e:{try{ds(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ks[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&As.$.h.call(this)}}ns(As,as);var ks={2:"touch",3:"pen",4:"mouse"};As.prototype.h=function(){As.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Ns="closure_listenable_"+(1e6*Math.random()|0),Ds=0;function Rs(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++Ds,this.fa=this.ia=!1}function Os(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Ps(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function Ls(e){const t={};for(const n in e)t[n]=e[n];return t}const Ms="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xs(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<Ms.length;t++)n=Ms[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function Us(e){this.src=e,this.g={},this.h=0}function Fs(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=rs(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Os(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Vs(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==i)return r}return-1}Us.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Vs(e,t,i,r);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Rs(t,this.src,s,!!i,r)).ia=n,e.push(t)),t};var js="closure_lm_"+(1e6*Math.random()|0),Bs={};function $s(e,t,n,i,r){if(i&&i.once)return qs(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)$s(e,t[s],n,i,r);return null}return n=Xs(n),e&&e[Ns]?e.O(t,n,Qr(i)?!!i.capture:!!i,r):zs(e,t,n,!1,i,r)}function zs(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=Qr(r)?!!r.capture:!!r,a=Qs(e);if(a||(e[js]=a=new Us(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){const e=Ws;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)cs||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Gs(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function qs(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)qs(e,t[s],n,i,r);return null}return n=Xs(n),e&&e[Ns]?e.P(t,n,Qr(i)?!!i.capture:!!i,r):zs(e,t,n,!0,i,r)}function Hs(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)Hs(e,t[s],n,i,r);else i=Qr(i)?!!i.capture:!!i,n=Xs(n),e&&e[Ns]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Vs(s=e.g[t],n,i,r))&&(Os(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Qs(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Vs(t,n,i,r)),(n=-1<e?t[e]:null)&&Ks(n))}function Ks(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Ns])Fs(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Gs(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Qs(t))?(Fs(n,e),0==n.h&&(n.src=null,t[js]=null)):Os(e)}}}function Gs(e){return e in Bs?Bs[e]:Bs[e]="on"+e}function Ws(e,t){if(e.fa)e=!0;else{t=new As(t,this);var n=e.listener,i=e.la||e.src;e.ia&&Ks(e),e=n.call(i,t)}return e}function Qs(e){return(e=e[js])instanceof Us?e:null}var Js="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xs(e){return"function"==typeof e?e:(e[Js]||(e[Js]=function(t){return e.handleEvent(t)}),e[Js])}function Ys(){is.call(this),this.i=new Us(this),this.S=this,this.J=null}function Zs(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new as(t,e);else if(t instanceof as)t.target=t.target||e;else{var r=t;xs(t=new as(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=eo(o,i,!0,t)&&r}if(r=eo(o=t.g=e,i,!0,t)&&r,r=eo(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=eo(o=t.g=n[s],i,!1,t)&&r}function eo(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Fs(e.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}ns(Ys,is),Ys.prototype[Ns]=!0,Ys.prototype.removeEventListener=function(e,t,n,i){Hs(this,e,t,n,i)},Ys.prototype.N=function(){if(Ys.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Os(n[i]);delete t.g[e],t.h--}}this.J=null},Ys.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},Ys.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var to=Gr.JSON.stringify;function no(){var e=uo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var io=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new ro),(e=>e.reset()));class ro{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function so(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function oo(e){Gr.setTimeout((()=>{throw e}),0)}let ao,co=!1,uo=new class{constructor(){this.h=this.g=null}add(e,t){const n=io.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},lo=()=>{const e=Gr.Promise.resolve(void 0);ao=()=>{e.then(ho)}};var ho=()=>{for(var e;e=no();){try{e.h.call(e.g)}catch(e){oo(e)}var t=io;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}co=!1};function fo(e,t){Ys.call(this),this.h=e||1,this.g=t||Gr,this.j=es(this.qb,this),this.l=Date.now()}function po(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function go(e,t,n){if("function"==typeof e)n&&(e=es(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=es(e.handleEvent,e)}return 2147483647<Number(t)?-1:Gr.setTimeout(e,t||0)}function mo(e){e.g=go((()=>{e.g=null,e.i&&(e.i=!1,mo(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}ns(fo,Ys),(zr=fo.prototype).ga=!1,zr.T=null,zr.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Zs(this,"tick"),this.ga&&(po(this),this.start()))}},zr.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},zr.N=function(){fo.$.N.call(this),po(this),delete this.g};class yo extends is{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mo(this)}N(){super.N(),this.g&&(Gr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vo(e){is.call(this),this.h=e,this.g={}}ns(vo,is);var wo=[];function bo(e,t,n,i){Array.isArray(n)||(n&&(wo[0]=n.toString()),n=wo);for(var r=0;r<n.length;r++){var s=$s(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Io(e){Ps(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Ks(e)}),e),e.g={}}function Eo(){this.g=!0}function _o(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return to(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}vo.prototype.N=function(){vo.$.N.call(this),Io(this)},vo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Eo.prototype.Ea=function(){this.g=!1},Eo.prototype.info=function(){};var To={},So=null;function Co(){return So=So||new Ys}function Ao(e){as.call(this,To.Ta,e)}function ko(e){const t=Co();Zs(t,new Ao(t))}function No(e,t){as.call(this,To.STAT_EVENT,e),this.stat=t}function Do(e){const t=Co();Zs(t,new No(t,e))}function Ro(e,t){as.call(this,To.Ua,e),this.size=t}function Oo(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Gr.setTimeout((function(){e()}),t)}To.Ta="serverreachability",ns(Ao,as),To.STAT_EVENT="statevent",ns(No,as),To.Ua="timingevent",ns(Ro,as);var Po={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Lo={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Mo(){}function xo(e){return e.h||(e.h=e.i())}function Uo(){}Mo.prototype.h=null;var Fo,Vo={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function jo(){as.call(this,"d")}function Bo(){as.call(this,"c")}function $o(){}function zo(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new vo(this),this.P=Ho,e=ws?125:void 0,this.V=new fo(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new qo}function qo(){this.i=null,this.g="",this.h=!1}ns(jo,as),ns(Bo,as),ns($o,Mo),$o.prototype.g=function(){return new XMLHttpRequest},$o.prototype.i=function(){return{}},Fo=new $o;var Ho=45e3,Ko={},Go={};function Wo(e,t,n){e.L=1,e.A=fa(ca(t)),e.u=n,e.S=!0,Qo(e,null)}function Qo(e,t){e.G=Date.now(),Zo(e),e.B=ca(e.A);var n=e.B,i=e.W;Array.isArray(i)||(i=[String(i)]),Ca(n.i,"t",i),e.o=0,n=e.l.J,e.h=new qo,e.g=Cc(e.l,n?t:null,!e.u),0<e.O&&(e.M=new yo(es(e.Pa,e,e.g),e.O)),bo(e.U,e.g,"readystatechange",e.nb),t=e.I?Ls(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),ko(),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.W,e.u)}function Jo(e){return!!e.g&&"GET"==e.v&&2!=e.L&&e.l.Ha}function Xo(e,t,n){let i,r=!0;for(;!e.J&&e.o<n.length;){if(i=Yo(e,n),i==Go){4==t&&(e.s=4,Do(14),r=!1),_o(e.j,e.m,null,"[Incomplete Response]");break}if(i==Ko){e.s=4,Do(15),_o(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}_o(e.j,e.m,i,null),ra(e,i)}Jo(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,Do(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),vc(t),t.M=!0,Do(11))):(_o(e.j,e.m,n,"[Invalid Chunked Response]"),ia(e),na(e))}function Yo(e,t){var n=e.o,i=t.indexOf("\n",n);return-1==i?Go:(n=Number(t.substring(n,i)),isNaN(n)?Ko:(i+=1)+n>t.length?Go:(t=t.slice(i,i+n),e.o=i+n,t))}function Zo(e){e.Y=Date.now()+e.P,ea(e,e.P)}function ea(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=Oo(es(e.lb,e),t)}function ta(e){e.C&&(Gr.clearTimeout(e.C),e.C=null)}function na(e){0==e.l.H||e.J||Ic(e.l,e)}function ia(e){ta(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,po(e.V),Io(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function ra(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Pa(n.i,e)))if(!e.K&&Pa(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;bc(n),lc(n)}yc(n),Do(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Oo(es(n.ib,n),6e3));if(1>=Oa(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else _c(n,11)}else if((e.K||n.g==e)&&bc(n),!us(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let u=r[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=u[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(La(s,s.h),s.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,da(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=Sc(i,i.J?i.pa:null,i.Y),o.K){Ma(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(ta(a),Zo(a)),i.g=o}else mc(i);0<n.j.length&&dc(n)}else"stop"!=u[0]&&"close"!=u[0]||_c(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?_c(n,7):uc(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}ko()}catch(e){}}function sa(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Wr(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Wr(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Wr(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}(zr=zo.prototype).setTimeout=function(e){this.P=e},zr.nb=function(e){e=e.target;const t=this.M;t&&3==ic(e)?t.l():this.Pa(e)},zr.Pa=function(e){try{if(e==this.g)e:{const l=ic(this.g);var t=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||ws||this.g&&(this.h.h||this.g.ja()||rc(this.g)))){this.J||4!=l||7==t||ko(),ta(this);var n=this.g.da();this.ca=n;t:if(Jo(this)){var i=rc(this.g);e="";var r=i.length,s=4==ic(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ia(this),na(this);var o="";break t}this.h.i=new Gr.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!us(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.s=3,Do(12),ia(this),na(this);break e}_o(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ra(this,n)}this.S?(Xo(this,l,o),ws&&this.i&&3==l&&(bo(this.U,this.V,"tick",this.mb),this.V.start())):(_o(this.j,this.m,o,null),ra(this,o)),4==l&&ia(this),this.i&&!this.J&&(4==l?Ic(this.l,this):(this.i=!1,Zo(this)))}else(function(e){const t={};e=(e.g&&2<=ic(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(us(e[i]))continue;var n=so(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Do(12)):(this.s=0,Do(13)),ia(this),na(this)}}}catch(e){}},zr.mb=function(){if(this.g){var e=ic(this.g),t=this.g.ja();this.o<t.length&&(ta(this),Xo(this,e,t),this.i&&4!=e&&Zo(this))}},zr.cancel=function(){this.J=!0,ia(this)},zr.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.L&&(ko(),Do(17)),ia(this),this.s=2,na(this)):ea(this,this.Y-e)};var oa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function aa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof aa){this.h=e.h,ua(this,e.j),this.s=e.s,this.g=e.g,la(this,e.m),this.l=e.l;var t=e.i,n=new Ea;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ha(this,n),this.o=e.o}else e&&(t=String(e).match(oa))?(this.h=!1,ua(this,t[1]||"",!0),this.s=pa(t[2]||""),this.g=pa(t[3]||"",!0),la(this,t[4]),this.l=pa(t[5]||"",!0),ha(this,t[6]||"",!0),this.o=pa(t[7]||"")):(this.h=!1,this.i=new Ea(null,this.h))}function ca(e){return new aa(e)}function ua(e,t,n){e.j=n?pa(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function la(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ha(e,t,n){t instanceof Ea?(e.i=t,function(e,t){t&&!e.j&&(_a(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ta(this,t),Ca(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ga(t,ba)),e.i=new Ea(t,e.h))}function da(e,t,n){e.i.set(t,n)}function fa(e){return da(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function pa(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ga(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ma),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ma(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}aa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ga(t,ya,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(ga(t,ya,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ga(n,"/"==n.charAt(0)?wa:va,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",ga(n,Ia)),e.join("")};var ya=/[#\/\?@]/g,va=/[#\?:]/g,wa=/[#\?]/g,ba=/[#\?@]/g,Ia=/#/g;function Ea(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _a(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ta(e,t){_a(e),t=Aa(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Sa(e,t){return _a(e),t=Aa(e,t),e.g.has(t)}function Ca(e,t,n){Ta(e,t),0<n.length&&(e.i=null,e.g.set(Aa(e,t),ss(n)),e.h+=n.length)}function Aa(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(zr=Ea.prototype).add=function(e,t){_a(this),this.i=null,e=Aa(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},zr.forEach=function(e,t){_a(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},zr.ta=function(){_a(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},zr.Z=function(e){_a(this);let t=[];if("string"==typeof e)Sa(this,e)&&(t=t.concat(this.g.get(Aa(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},zr.set=function(e,t){return _a(this),this.i=null,Sa(this,e=Aa(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},zr.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},zr.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")};var ka=class{constructor(e,t){this.g=e,this.map=t}};function Na(e){this.l=e||Da,e=Gr.PerformanceNavigationTiming?0<(e=Gr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Gr.g&&Gr.g.Ka&&Gr.g.Ka()&&Gr.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Da=10;function Ra(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Oa(e){return e.h?1:e.g?e.g.size:0}function Pa(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function La(e,t){e.g?e.g.add(t):e.h=t}function Ma(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function xa(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return ss(e.i)}Na.prototype.cancel=function(){if(this.i=xa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ua=class{stringify(e){return Gr.JSON.stringify(e,void 0)}parse(e){return Gr.JSON.parse(e,void 0)}};function Fa(){this.g=new Ua}function Va(e,t,n){const i=n||"";try{sa(e,(function(e,n){let r=e;Qr(e)&&(r=to(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function ja(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function Ba(e){this.l=e.ec||null,this.j=e.ob||!1}function $a(e,t){Ys.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=za,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ns(Ba,Mo),Ba.prototype.g=function(){return new $a(this.l,this.j)},Ba.prototype.i=function(e){return function(){return e}}({}),ns($a,Ys);var za=0;function qa(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Ha(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ka(e)}function Ka(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(zr=$a.prototype).open=function(e,t){if(this.readyState!=za)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ka(this)},zr.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Gr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},zr.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ha(this)),this.readyState=za},zr.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ka(this)),this.g&&(this.readyState=3,Ka(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Gr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qa(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},zr.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ha(this):Ka(this),3==this.readyState&&qa(this)}},zr.Za=function(e){this.g&&(this.response=this.responseText=e,Ha(this))},zr.Ya=function(e){this.g&&(this.response=e,Ha(this))},zr.ka=function(){this.g&&Ha(this)},zr.setRequestHeader=function(e,t){this.v.append(e,t)},zr.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},zr.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty($a.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Ga=Gr.JSON.parse;function Wa(e){Ys.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Qa,this.L=this.M=!1}ns(Wa,Ys);var Qa="",Ja=/^https?$/i,Xa=["POST","PUT"];function Ya(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Za(e),tc(e)}function Za(e){e.F||(e.F=!0,Zs(e,"complete"),Zs(e,"error"))}function ec(e){if(e.h&&void 0!==Kr&&(!e.C[1]||4!=ic(e)||2!=e.da()))if(e.v&&4==ic(e))go(e.La,0,e);else if(Zs(e,"readystatechange"),4==ic(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===o){var r=String(e.I).match(oa)[1]||null;!r&&Gr.self&&Gr.self.location&&(r=Gr.self.location.protocol.slice(0,-1)),i=!Ja.test(r?r.toLowerCase():"")}n=i}if(n)Zs(e,"complete"),Zs(e,"success");else{e.m=6;try{var s=2<ic(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",Za(e)}}finally{tc(e)}}}function tc(e,t){if(e.g){nc(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Zs(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function nc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Gr.clearTimeout(e.A),e.A=null)}function ic(e){return e.g?e.g.readyState:0}function rc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Qa:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function sc(e){let t="";return Ps(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function oc(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=sc(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):da(e,t,n))}function ac(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function cc(e){this.Ga=0,this.j=[],this.l=new Eo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ac("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ac("baseRetryDelayMs",5e3,e),this.hb=ac("retryDelaySeedMs",1e4,e),this.eb=ac("forwardChannelMaxRetries",2,e),this.xa=ac("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Na(e&&e.concurrentRequestLimit),this.Ja=new Fa,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function uc(e){if(hc(e),3==e.H){var t=e.W++,n=ca(e.I);if(da(n,"SID",e.K),da(n,"RID",t),da(n,"TYPE","terminate"),pc(e,n),(t=new zo(e,e.l,t)).L=2,t.A=fa(ca(n)),n=!1,Gr.navigator&&Gr.navigator.sendBeacon)try{n=Gr.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&Gr.Image&&((new Image).src=t.A,n=!0),n||(t.g=Cc(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Zo(t)}Tc(e)}function lc(e){e.g&&(vc(e),e.g.cancel(),e.g=null)}function hc(e){lc(e),e.u&&(Gr.clearTimeout(e.u),e.u=null),bc(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Gr.clearTimeout(e.m),e.m=null)}function dc(e){if(!Ra(e.i)&&!e.m){e.m=!0;var t=e.Na;ao||lo(),co||(ao(),co=!0),uo.add(t,e),e.C=0}}function fc(e,t){var n;n=t?t.m:e.W++;const i=ca(e.I);da(i,"SID",e.K),da(i,"RID",n),da(i,"AID",e.V),pc(e,i),e.o&&e.s&&oc(i,e.o,e.s),n=new zo(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=gc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),La(e.i,n),Wo(n,i,t)}function pc(e,t){e.na&&Ps(e.na,(function(e,n){da(t,n,e)})),e.h&&sa({},(function(e,n){da(t,n,e)}))}function gc(e,t,n){n=Math.min(e.j.length,n);var i=e.h?es(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{Va(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function mc(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;ao||lo(),co||(ao(),co=!0),uo.add(t,e),e.A=0}}function yc(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=Oo(es(e.Ma,e),Ec(e,e.A)),e.A++,0))}function vc(e){null!=e.B&&(Gr.clearTimeout(e.B),e.B=null)}function wc(e){e.g=new zo(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=ca(e.wa);da(t,"RID","rpc"),da(t,"SID",e.K),da(t,"AID",e.V),da(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&da(t,"TO",e.qa),da(t,"TYPE","xmlhttp"),pc(e,t),e.o&&e.s&&oc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=fa(ca(t)),n.u=null,n.S=!0,Qo(n,e)}function bc(e){null!=e.v&&(Gr.clearTimeout(e.v),e.v=null)}function Ic(e,t){var n=null;if(e.g==t){bc(e),vc(e),e.g=null;var i=2}else{if(!Pa(e.i,t))return;n=t.F,Ma(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.u?t.u.length:0,t=Date.now()-t.G;var r=e.C;Zs(i=Co(),new Ro(i,n)),dc(e)}else mc(e);else if(3==(r=t.s)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(Oa(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=Oo(es(e.Na,e,t),Ec(e,e.C)),e.C++,0)))}(e,t)||2==i&&yc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:_c(e,5);break;case 4:_c(e,10);break;case 3:_c(e,6);break;default:_c(e,2)}}function Ec(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function _c(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=es(e.pb,e);n||(n=new aa("//www.google.com/images/cleardot.gif"),Gr.location&&"http"==Gr.location.protocol||ua(n,"https"),fa(n)),function(e,t){const n=new Eo;if(Gr.Image){const i=new Image;i.onload=ts(ja,n,i,"TestLoadImage: loaded",!0,t),i.onerror=ts(ja,n,i,"TestLoadImage: error",!1,t),i.onabort=ts(ja,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=ts(ja,n,i,"TestLoadImage: timeout",!1,t),Gr.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else Do(2);e.H=0,e.h&&e.h.za(t),Tc(e),hc(e)}function Tc(e){if(e.H=0,e.ma=[],e.h){const t=xa(e.i);0==t.length&&0==e.j.length||(os(e.ma,t),os(e.ma,e.j),e.i.i.length=0,ss(e.j),e.j.length=0),e.h.ya()}}function Sc(e,t,n){var i=n instanceof aa?ca(n):new aa(n);if(""!=i.g)t&&(i.g=t+"."+i.g),la(i,i.m);else{var r=Gr.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new aa(null);i&&ua(s,i),t&&(s.g=t),r&&la(s,r),n&&(s.l=n),i=s}return n=e.F,t=e.Da,n&&t&&da(i,n,t),da(i,"VER",e.ra),pc(e,i),i}function Cc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ha&&!e.va?new Wa(new Ba({ob:n})):new Wa(e.va)).Oa(e.J),t}function Ac(){}function kc(){if(ys&&!(10<=Number(Cs)))throw Error("Environmental error: no available transport.")}function Nc(e,t){Ys.call(this),this.g=new cc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!us(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!us(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Oc(this)}function Dc(e){jo.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Rc(){Bo.call(this),this.status=1}function Oc(e){this.g=e}function Pc(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Lc(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function Mc(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}(zr=Wa.prototype).Oa=function(e){this.M=e},zr.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Fo.g(),this.C=this.u?xo(this.u):xo(Fo),this.g.onreadystatechange=es(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void Ya(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=Gr.FormData&&e instanceof Gr.FormData,!(0<=rs(Xa,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{nc(this),0<this.B&&((this.L=function(e){return ys&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=es(this.ua,this)):this.A=go(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ya(this,e)}},zr.ua=function(){void 0!==Kr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Zs(this,"timeout"),this.abort(8))},zr.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Zs(this,"complete"),Zs(this,"abort"),tc(this))},zr.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),tc(this,!0)),Wa.$.N.call(this)},zr.La=function(){this.s||(this.G||this.v||this.l?ec(this):this.kb())},zr.kb=function(){ec(this)},zr.isActive=function(){return!!this.g},zr.da=function(){try{return 2<ic(this)?this.g.status:-1}catch(e){return-1}},zr.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},zr.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ga(t)}},zr.Ia=function(){return this.m},zr.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(zr=cc.prototype).ra=8,zr.H=1,zr.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new zo(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Ls(s),xs(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=gc(this,r,t),da(n=ca(this.I),"RID",e),da(n,"CVER",22),this.F&&da(n,"X-HTTP-Session-Id",this.F),pc(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(sc(s)))+"&"+t:this.o&&oc(n,this.o,s)),La(this.i,r),this.bb&&da(n,"TYPE","init"),this.P?(da(n,"$req",t),da(n,"SID","null"),r.aa=!0,Wo(r,n,null)):Wo(r,n,t),this.H=2}}else 3==this.H&&(e?fc(this,e):0==this.j.length||Ra(this.i)||fc(this))},zr.Ma=function(){if(this.u=null,wc(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Oo(es(this.jb,this),e)}},zr.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Do(10),lc(this),wc(this))},zr.ib=function(){null!=this.v&&(this.v=null,lc(this),yc(this),Do(19))},zr.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Do(2)):(this.l.info("Failed to ping google.com"),Do(1))},zr.isActive=function(){return!!this.h&&this.h.isActive(this)},(zr=Ac.prototype).Ba=function(){},zr.Aa=function(){},zr.za=function(){},zr.ya=function(){},zr.isActive=function(){return!0},zr.Va=function(){},kc.prototype.g=function(e,t){return new Nc(e,t)},ns(Nc,Ys),Nc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Do(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Sc(e,null,e.Y),dc(e)},Nc.prototype.close=function(){uc(this.g)},Nc.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=to(e),e=n);t.j.push(new ka(t.fb++,e)),3==t.H&&dc(t)},Nc.prototype.N=function(){this.g.h=null,delete this.j,uc(this.g),delete this.g,Nc.$.N.call(this)},ns(Dc,jo),ns(Rc,Bo),ns(Oc,Ac),Oc.prototype.Ba=function(){Zs(this.g,"a")},Oc.prototype.Aa=function(e){Zs(this.g,new Dc(e))},Oc.prototype.za=function(e){Zs(this.g,new Rc)},Oc.prototype.ya=function(){Zs(this.g,"b")},ns(Pc,(function(){this.blockSize=-1})),Pc.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Pc.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,s=0;s<t;){if(0==r)for(;s<=n;)Lc(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(i[r++]=e.charCodeAt(s++),r==this.blockSize){Lc(this,i),r=0;break}}else for(;s<t;)if(i[r++]=e[s++],r==this.blockSize){Lc(this,i),r=0;break}}this.h=r,this.i+=t},Pc.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var xc={};function Uc(e){return-128<=e&&128>e?function(e,t){var n=xc;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new Mc([0|e],0>e?-1:0)}(e)}(e):new Mc([0|e],0>e?-1:0)}function Fc(e){if(isNaN(e)||!isFinite(e))return jc;if(0>e)return Hc(Fc(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=Vc;return new Mc(t,0)}var Vc=4294967296,jc=Uc(0),Bc=Uc(1),$c=Uc(16777216);function zc(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function qc(e){return-1==e.h}function Hc(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new Mc(n,~e.h).add(Bc)}function Kc(e,t){return e.add(Hc(t))}function Gc(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Wc(e,t){this.g=e,this.h=t}function Qc(e,t){if(zc(t))throw Error("division by zero");if(zc(e))return new Wc(jc,jc);if(qc(e))return t=Qc(Hc(e),t),new Wc(Hc(t.g),Hc(t.h));if(qc(t))return t=Qc(e,Hc(t)),new Wc(Hc(t.g),t.h);if(30<e.g.length){if(qc(e)||qc(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Bc,i=t;0>=i.X(e);)n=Jc(n),i=Jc(i);var r=Xc(n,1),s=Xc(i,1);for(i=Xc(i,2),n=Xc(n,2);!zc(i);){var o=s.add(i);0>=o.X(e)&&(r=r.add(n),s=o),i=Xc(i,1),n=Xc(n,1)}return t=Kc(e,r.R(t)),new Wc(r,t)}for(r=jc;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=Fc(n)).R(t);qc(o)||0<o.X(e);)o=(s=Fc(n-=i)).R(t);zc(s)&&(s=Bc),r=r.add(s),e=Kc(e,o)}return new Wc(r,e)}function Jc(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new Mc(n,e.h)}function Xc(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],s=0;s<i;s++)r[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Mc(r,e.h)}(zr=Mc.prototype).ea=function(){if(qc(this))return-Hc(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:Vc+i)*t,t*=Vc}return e},zr.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(zc(this))return"0";if(qc(this))return"-"+Hc(this).toString(e);for(var t=Fc(Math.pow(e,6)),n=this,i="";;){var r=Qc(n,t).g,s=((0<(n=Kc(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(zc(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},zr.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},zr.X=function(e){return qc(e=Kc(this,e))?-1:zc(e)?0:1},zr.abs=function(){return qc(this)?Hc(this):this},zr.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var s=i+(65535&this.D(r))+(65535&e.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Mc(n,-2147483648&n[n.length-1]?-1:0)},zr.R=function(e){if(zc(this)||zc(e))return jc;if(qc(this))return qc(e)?Hc(this).R(Hc(e)):Hc(Hc(this).R(e));if(qc(e))return Hc(this.R(Hc(e)));if(0>this.X($c)&&0>e.X($c))return Fc(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=e.D(r)>>>16,c=65535&e.D(r);n[2*i+2*r]+=o*c,Gc(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Gc(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Gc(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Gc(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new Mc(n,0)},zr.gb=function(e){return Qc(this,e).h},zr.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new Mc(n,this.h&e.h)},zr.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new Mc(n,this.h|e.h)},zr.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new Mc(n,this.h^e.h)},kc.prototype.createWebChannel=kc.prototype.g,Nc.prototype.send=Nc.prototype.u,Nc.prototype.open=Nc.prototype.m,Nc.prototype.close=Nc.prototype.close,Po.NO_ERROR=0,Po.TIMEOUT=8,Po.HTTP_ERROR=6,Lo.COMPLETE="complete",Uo.EventType=Vo,Vo.OPEN="a",Vo.CLOSE="b",Vo.ERROR="c",Vo.MESSAGE="d",Ys.prototype.listen=Ys.prototype.O,Wa.prototype.listenOnce=Wa.prototype.P,Wa.prototype.getLastError=Wa.prototype.Sa,Wa.prototype.getLastErrorCode=Wa.prototype.Ia,Wa.prototype.getStatus=Wa.prototype.da,Wa.prototype.getResponseJson=Wa.prototype.Wa,Wa.prototype.getResponseText=Wa.prototype.ja,Wa.prototype.send=Wa.prototype.ha,Wa.prototype.setWithCredentials=Wa.prototype.Oa,Pc.prototype.digest=Pc.prototype.l,Pc.prototype.reset=Pc.prototype.reset,Pc.prototype.update=Pc.prototype.j,Mc.prototype.add=Mc.prototype.add,Mc.prototype.multiply=Mc.prototype.R,Mc.prototype.modulo=Mc.prototype.gb,Mc.prototype.compare=Mc.prototype.X,Mc.prototype.toNumber=Mc.prototype.ea,Mc.prototype.toString=Mc.prototype.toString,Mc.prototype.getBits=Mc.prototype.D,Mc.fromNumber=Fc,Mc.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Hc(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Fc(Math.pow(n,8)),r=jc,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Fc(Math.pow(n,o)),r=r.R(o).add(Fc(a))):r=(r=r.R(i)).add(Fc(a))}return r};var Yc=Hr.createWebChannelTransport=function(){return new kc},Zc=Hr.getStatEventTarget=function(){return Co()},eu=Hr.ErrorCode=Po,tu=Hr.EventType=Lo,nu=Hr.Event=To,iu=Hr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ru=(Hr.FetchXmlHttpFactory=Ba,Hr.WebChannel=Uo),su=Hr.XhrIo=Wa,ou=(Hr.Md5=Pc,Hr.Integer=Mc);const au="@firebase/firestore";class cu{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cu.UNAUTHENTICATED=new cu(null),cu.GOOGLE_CREDENTIALS=new cu("google-credentials-uid"),cu.FIRST_PARTY=new cu("first-party-uid"),cu.MOCK_USER=new cu("mock-user");let uu="10.8.1";const lu=new B("@firebase/firestore");function hu(){return lu.logLevel}function du(e,...t){if(lu.logLevel<=x.DEBUG){const n=t.map(gu);lu.debug(`Firestore (${uu}): ${e}`,...n)}}function fu(e,...t){if(lu.logLevel<=x.ERROR){const n=t.map(gu);lu.error(`Firestore (${uu}): ${e}`,...n)}}function pu(e,...t){if(lu.logLevel<=x.WARN){const n=t.map(gu);lu.warn(`Firestore (${uu}): ${e}`,...n)}}function gu(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function mu(e="Unexpected state"){const t=`FIRESTORE (${uu}) INTERNAL ASSERTION FAILED: `+e;throw fu(t),new Error(t)}function yu(e,t){e||mu()}function vu(e,t){return e}const wu={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bu extends g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Iu{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Eu{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _u{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(cu.UNAUTHENTICATED)))}shutdown(){}}class Tu{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Su{constructor(e){this.t=e,this.currentUser=cu.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new Iu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Iu,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{du("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(du("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Iu)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(du("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(yu("string"==typeof t.accessToken),new Eu(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return yu(null===e||"string"==typeof e),new cu(e)}}class Cu{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=cu.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Au{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Cu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(cu.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ku{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nu{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&du("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,du("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{du("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):du("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(yu("string"==typeof e.token),this.R=e.token,new ku(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Du(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Ru{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Du(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function Ou(e,t){return e<t?-1:e>t?1:0}function Pu(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class Lu{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new bu(wu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new bu(wu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new bu(wu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new bu(wu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Lu.fromMillis(Date.now())}static fromDate(e){return Lu.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Lu(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ou(this.nanoseconds,e.nanoseconds):Ou(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Mu{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Mu(e)}static min(){return new Mu(new Lu(0,0))}static max(){return new Mu(new Lu(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class xu{constructor(e,t,n){void 0===t?t=0:t>e.length&&mu(),void 0===n?n=e.length-t:n>e.length-t&&mu(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===xu.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xu?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Uu extends xu{construct(e,t,n){return new Uu(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new bu(wu.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Uu(t)}static emptyPath(){return new Uu([])}}const Fu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vu extends xu{construct(e,t,n){return new Vu(e,t,n)}static isValidIdentifier(e){return Fu.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vu.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Vu(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new bu(wu.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new bu(wu.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new bu(wu.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new bu(wu.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vu(t)}static emptyPath(){return new Vu([])}}class ju{constructor(e){this.path=e}static fromPath(e){return new ju(Uu.fromString(e))}static fromName(e){return new ju(Uu.fromString(e).popFirst(5))}static empty(){return new ju(Uu.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Uu.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Uu.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ju(new Uu(e.slice()))}}function Bu(e){return new $u(e.readTime,e.key,-1)}class $u{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new $u(Mu.min(),ju.empty(),-1)}static max(){return new $u(Mu.max(),ju.empty(),-1)}}function zu(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ju.comparator(e.documentKey,t.documentKey),0!==n?n:Ou(e.largestBatchId,t.largestBatchId))}const qu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hu{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ku(e){if(e.code!==wu.FAILED_PRECONDITION||e.message!==qu)throw e;du("LocalStore","Unexpectedly lost primary lease")}class Gu{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&mu(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Gu(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Gu?t:Gu.resolve(t)}catch(e){return Gu.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Gu.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Gu.reject(t)}static resolve(e){return new Gu(((t,n)=>{t(e)}))}static reject(e){return new Gu(((t,n)=>{n(e)}))}static waitFor(e){return new Gu(((t,n)=>{let i=0,r=0,s=!1;e.forEach((e=>{++i,e.next((()=>{++r,s&&r===i&&t()}),(e=>n(e)))})),s=!0,r===i&&t()}))}static or(e){let t=Gu.resolve(!1);for(const n of e)t=t.next((e=>e?Gu.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new Gu(((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===r&&n(s)}),(e=>i(e)))}}))}static doWhile(e,t){return new Gu(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}class Wu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Iu,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Xu(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=nl(t.target.error);this.V.reject(new Xu(e,n))}}static open(e,t,n,i){try{return new Wu(t,e.transaction(i,n))}catch(e){throw new Xu(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(du("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Zu(t)}}class Qu{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===Qu.S(h())&&fu("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return du("SimpleDb","Removing database:",e),el(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!f())return!1;if(Qu.C())return!0;const e=h(),t=Qu.S(e),n=0<t&&t<10,i=Qu.v(e),r=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||r)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(du("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{const n=e.target.result;t(n)},i.onblocked=()=>{n(new Xu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=t=>{const i=t.target.error;"VersionError"===i.name?n(new bu(wu.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new bu(wu.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Xu(e,i))},i.onupgradeneeded=e=>{du("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,i.transaction,e.oldVersion,this.version).next((()=>{du("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=e=>this.B(e)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const r="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.O(e);const t=Wu.open(this.db,e,r?"readonly":"readwrite",n),s=i(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Gu.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(du("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Ju{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return el(this.k.delete())}}class Xu extends bu{constructor(e,t){super(wu.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Yu(e){return"IndexedDbTransactionError"===e.name}class Zu{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(du("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(du("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),el(n)}add(e){return du("SimpleDb","ADD",this.store.name,e,e),el(this.store.add(e))}get(e){return el(this.store.get(e)).next((t=>(void 0===t&&(t=null),du("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return du("SimpleDb","DELETE",this.store.name,e),el(this.store.delete(e))}count(){return du("SimpleDb","COUNT",this.store.name),el(this.store.count())}W(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const e=i.getAll(n.range);return new Gu(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Gu(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){du("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const i=this.cursor(n);return this.G(i,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.G(i,t)}Z(e){const t=this.cursor({});return new Gu(((n,i)=>{t.onerror=e=>{const t=nl(e.target.error);i(t)},t.onsuccess=t=>{const i=t.target.result;i?e(i.primaryKey,i.value).next((e=>{e?i.continue():n()})):n()}}))}G(e,t){const n=[];return new Gu(((i,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{const r=e.target.result;if(!r)return void i();const s=new Ju(r),o=t(r.primaryKey,r.value,s);if(o instanceof Gu){const e=o.catch((e=>(s.done(),Gu.reject(e))));n.push(e)}s.isDone?i():null===s.$?r.continue():r.continue(s.$)}})).next((()=>Gu.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function el(e){return new Gu(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=nl(e.target.error);n(t)}}))}let tl=!1;function nl(e){const t=Qu.S(h());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new bu("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tl||(tl=!0,setTimeout((()=>{throw e}),0)),e}}return e}class il{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function rl(e){return null==e}function sl(e){return 0===e&&1/e==-1/0}il._e=-1;function ol(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function al(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function cl(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ul{constructor(e,t){this.comparator=e,this.root=t||hl.EMPTY}insert(e,t){return new ul(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,hl.BLACK,null,null))}remove(e){return new ul(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hl.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ll(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ll(this.root,e,this.comparator,!1)}getReverseIterator(){return new ll(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ll(this.root,e,this.comparator,!0)}}class ll{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class hl{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:hl.RED,this.left=null!=i?i:hl.EMPTY,this.right=null!=r?r:hl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new hl(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return hl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return hl.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mu();if(this.right.isRed())throw mu();const e=this.left.check();if(e!==this.right.check())throw mu();return e+(this.isRed()?0:1)}}hl.EMPTY=null,hl.RED=!0,hl.BLACK=!1,hl.EMPTY=new class{constructor(){this.size=0}get key(){throw mu()}get value(){throw mu()}get color(){throw mu()}get left(){throw mu()}get right(){throw mu()}copy(e,t,n,i,r){return this}insert(e,t,n){return new hl(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class dl{constructor(e){this.comparator=e,this.data=new ul(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fl(this.data.getIterator())}getIteratorFrom(e){return new fl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof dl))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new dl(this.comparator);return t.data=e,t}}class fl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class pl{constructor(e){this.fields=e,e.sort(Vu.comparator)}static empty(){return new pl([])}unionWith(e){let t=new dl(Vu.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new pl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pu(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class gl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ml{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new gl("Invalid base64 string: "+e):e}}(e);return new ml(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ml(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ou(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ml.EMPTY_BYTE_STRING=new ml("");const yl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vl(e){if(yu(!!e),"string"==typeof e){let t=0;const n=yl.exec(e);if(yu(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:wl(e.seconds),nanos:wl(e.nanos)}}function wl(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function bl(e){return"string"==typeof e?ml.fromBase64String(e):ml.fromUint8Array(e)}function Il(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function El(e){const t=e.mapValue.fields.__previous_value__;return Il(t)?El(t):t}function _l(e){const t=vl(e.mapValue.fields.__local_write_time__.timestampValue);return new Lu(t.seconds,t.nanos)}class Tl{constructor(e,t,n,i,r,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Sl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Sl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Sl&&e.projectId===this.projectId&&e.database===this.database}}const Cl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Al(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Il(e)?4:Fl(e)?9007199254740991:10:mu()}function kl(e,t){if(e===t)return!0;const n=Al(e);if(n!==Al(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return _l(e).isEqual(_l(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=vl(e.timestampValue),i=vl(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return bl(e.bytesValue).isEqual(bl(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return wl(e.geoPointValue.latitude)===wl(t.geoPointValue.latitude)&&wl(e.geoPointValue.longitude)===wl(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return wl(e.integerValue)===wl(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=wl(e.doubleValue),i=wl(t.doubleValue);return n===i?sl(n)===sl(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Pu(e.arrayValue.values||[],t.arrayValue.values||[],kl);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(ol(n)!==ol(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!kl(n[e],i[e])))return!1;return!0}(e,t);default:return mu()}}function Nl(e,t){return void 0!==(e.values||[]).find((e=>kl(e,t)))}function Dl(e,t){if(e===t)return 0;const n=Al(e),i=Al(t);if(n!==i)return Ou(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ou(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=wl(e.integerValue||e.doubleValue),i=wl(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Rl(e.timestampValue,t.timestampValue);case 4:return Rl(_l(e),_l(t));case 5:return Ou(e.stringValue,t.stringValue);case 6:return function(e,t){const n=bl(e),i=bl(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=Ou(n[e],i[e]);if(0!==t)return t}return Ou(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ou(wl(e.latitude),wl(t.latitude));return 0!==n?n:Ou(wl(e.longitude),wl(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Dl(n[e],i[e]);if(t)return t}return Ou(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Cl.mapValue&&t===Cl.mapValue)return 0;if(e===Cl.mapValue)return 1;if(t===Cl.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){const t=Ou(i[e],s[e]);if(0!==t)return t;const o=Dl(n[i[e]],r[s[e]]);if(0!==o)return o}return Ou(i.length,s.length)}(e.mapValue,t.mapValue);default:throw mu()}}function Rl(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ou(e,t);const n=vl(e),i=vl(t),r=Ou(n.seconds,i.seconds);return 0!==r?r:Ou(n.nanos,i.nanos)}function Ol(e){return Pl(e)}function Pl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=vl(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return bl(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ju.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Pl(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Pl(e.fields[r])}`;return n+"}"}(e.mapValue):mu()}function Ll(e){return!!e&&"integerValue"in e}function Ml(e){return!!e&&"arrayValue"in e}function xl(e){return!!e&&"mapValue"in e}function Ul(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return al(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Ul(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ul(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Fl(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Vl{constructor(e){this.value=e}static empty(){return new Vl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!xl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ul(t)}setAll(e){let t=Vu.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=Ul(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());xl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return kl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];xl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){al(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Vl(Ul(this.value))}}function jl(e){const t=[];return al(e.fields,((e,n)=>{const i=new Vu([e]);if(xl(n)){const e=jl(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new pl(t)}class Bl{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Bl(e,0,Mu.min(),Mu.min(),Mu.min(),Vl.empty(),0)}static newFoundDocument(e,t,n,i){return new Bl(e,1,t,Mu.min(),n,i,0)}static newNoDocument(e,t){return new Bl(e,2,t,Mu.min(),Mu.min(),Vl.empty(),0)}static newUnknownDocument(e,t){return new Bl(e,3,t,Mu.min(),Mu.min(),Vl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Mu.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mu.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Bl&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bl(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $l{constructor(e,t){this.position=e,this.inclusive=t}}function zl(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?ju.comparator(ju.fromName(o.referenceValue),n.key):Dl(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function ql(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!kl(e.position[n],t.position[n]))return!1;return!0}class Hl{constructor(e,t="asc"){this.field=e,this.dir=t}}function Kl(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Gl{}class Wl extends Gl{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new th(e,t,n):"array-contains"===t?new sh(e,n):"in"===t?new oh(e,n):"not-in"===t?new ah(e,n):"array-contains-any"===t?new ch(e,n):new Wl(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new nh(e,n):new ih(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Dl(t,this.value)):null!==t&&Al(this.value)===Al(t)&&this.matchesComparison(Dl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return mu()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ql extends Gl{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Ql(e,t)}matches(e){return Jl(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Jl(e){return"and"===e.op}function Xl(e){return function(e){for(const t of e.filters)if(t instanceof Ql)return!1;return!0}(e)&&Jl(e)}function Yl(e){if(e instanceof Wl)return e.field.canonicalString()+e.op.toString()+Ol(e.value);if(Xl(e))return e.filters.map((e=>Yl(e))).join(",");{const t=e.filters.map((e=>Yl(e))).join(",");return`${e.op}(${t})`}}function Zl(e,t){return e instanceof Wl?function(e,t){return t instanceof Wl&&e.op===t.op&&e.field.isEqual(t.field)&&kl(e.value,t.value)}(e,t):e instanceof Ql?function(e,t){return t instanceof Ql&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&Zl(n,t.filters[i])),!0)}(e,t):void mu()}function eh(e){return e instanceof Wl?function(e){return`${e.field.canonicalString()} ${e.op} ${Ol(e.value)}`}(e):e instanceof Ql?function(e){return e.op.toString()+" {"+e.getFilters().map(eh).join(" ,")+"}"}(e):"Filter"}class th extends Wl{constructor(e,t,n){super(e,t,n),this.key=ju.fromName(n.referenceValue)}matches(e){const t=ju.comparator(e.key,this.key);return this.matchesComparison(t)}}class nh extends Wl{constructor(e,t){super(e,"in",t),this.keys=rh(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ih extends Wl{constructor(e,t){super(e,"not-in",t),this.keys=rh(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function rh(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>ju.fromName(e.referenceValue)))}class sh extends Wl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ml(t)&&Nl(t.arrayValue,this.value)}}class oh extends Wl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Nl(this.value.arrayValue,t)}}class ah extends Wl{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Nl(this.value.arrayValue,t)}}class ch extends Wl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ml(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Nl(this.value.arrayValue,e)))}}class uh{constructor(e,t=null,n=[],i=[],r=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function lh(e,t=null,n=[],i=[],r=null,s=null,o=null){return new uh(e,t,n,i,r,s,o)}function hh(e){const t=vu(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Yl(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),rl(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ol(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ol(e))).join(",")),t.ce=e}return t.ce}function dh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Kl(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Zl(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ql(e.startAt,t.startAt)&&ql(e.endAt,t.endAt)}class fh{constructor(e,t=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function ph(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function gh(e){const t=vu(e);if(null===t.le){t.le=[];const e=new Set;for(const n of t.explicitOrderBy)t.le.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",i=function(e){let t=new dl(Vu.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);i.forEach((i=>{e.has(i.canonicalString())||i.isKeyField()||t.le.push(new Hl(i,n))})),e.has(Vu.keyField().canonicalString())||t.le.push(new Hl(Vu.keyField(),n))}return t.le}function mh(e){const t=vu(e);return t.he||(t.he=function(e,t){if("F"===e.limitType)return lh(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Hl(e.field,t)}));const n=e.endAt?new $l(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new $l(e.startAt.position,e.startAt.inclusive):null;return lh(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}(t,gh(e))),t.he}function yh(e,t,n){return new fh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vh(e,t){return dh(mh(e),mh(t))&&e.limitType===t.limitType}function wh(e){return`${hh(mh(e))}|lt:${e.limitType}`}function bh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>eh(e))).join(", ")}]`),rl(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ol(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ol(e))).join(",")),`Target(${t})`}(mh(e))}; limitType=${e.limitType})`}function Ih(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ju.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of gh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=zl(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,gh(e),t)||e.endAt&&!function(e,t,n){const i=zl(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,gh(e),t))}(e,t)}function Eh(e,t,n){const i=e.field.isKeyField()?ju.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Dl(i,r):mu()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return mu()}}class _h{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){al(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return cl(this.inner)}size(){return this.innerSize}}const Th=new ul(ju.comparator);function Sh(){return Th}const Ch=new ul(ju.comparator);function Ah(...e){let t=Ch;for(const n of e)t=t.insert(n.key,n);return t}function kh(e){let t=Ch;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Nh(){return Rh()}function Dh(){return Rh()}function Rh(){return new _h((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Oh=new ul(ju.comparator),Ph=new dl(ju.comparator);function Lh(...e){let t=Ph;for(const n of e)t=t.add(n);return t}const Mh=new dl(Ou);function xh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sl(t)?"-0":t}}function Uh(e){return{integerValue:""+e}}function Fh(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!sl(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Uh(t):xh(e,t)}class Vh{constructor(){this._=void 0}}function jh(e,t,n){return e instanceof zh?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Il(t)&&(t=El(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof qh?Hh(e,t):e instanceof Kh?Gh(e,t):function(e,t){const n=$h(e,t),i=Qh(n)+Qh(e.Ie);return Ll(n)&&Ll(e.Ie)?Uh(i):xh(e.serializer,i)}(e,t)}function Bh(e,t,n){return e instanceof qh?Hh(e,t):e instanceof Kh?Gh(e,t):n}function $h(e,t){return e instanceof Wh?function(e){return Ll(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class zh extends Vh{}class qh extends Vh{constructor(e){super(),this.elements=e}}function Hh(e,t){const n=Jh(t);for(const t of e.elements)n.some((e=>kl(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Kh extends Vh{constructor(e){super(),this.elements=e}}function Gh(e,t){let n=Jh(t);for(const t of e.elements)n=n.filter((e=>!kl(e,t)));return{arrayValue:{values:n}}}class Wh extends Vh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Qh(e){return wl(e.integerValue||e.doubleValue)}function Jh(e){return Ml(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Xh{constructor(e,t){this.field=e,this.transform=t}}class Yh{constructor(e,t){this.version=e,this.transformResults=t}}class Zh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zh}static exists(e){return new Zh(void 0,e)}static updateTime(e){return new Zh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ed(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class td{}function nd(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new dd(e.key,Zh.none()):new ad(e.key,e.data,Zh.none());{const n=e.data,i=Vl.empty();let r=new dl(Vu.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new cd(e.key,i,new pl(r.toArray()),Zh.none())}}function id(e,t,n){e instanceof ad?function(e,t,n){const i=e.value.clone(),r=ld(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof cd?function(e,t,n){if(!ed(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=ld(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(ud(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function rd(e,t,n,i){return e instanceof ad?function(e,t,n,i){if(!ed(e.precondition,t))return n;const r=e.value.clone(),s=hd(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof cd?function(e,t,n,i){if(!ed(e.precondition,t))return n;const r=hd(e.fieldTransforms,i,t),s=t.data;return s.setAll(ud(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return ed(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function sd(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=$h(i.transform,e||null);null!=r&&(null===n&&(n=Vl.empty()),n.set(i.field,r))}return n||null}function od(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Pu(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof qh&&t instanceof qh||e instanceof Kh&&t instanceof Kh?Pu(e.elements,t.elements,kl):e instanceof Wh&&t instanceof Wh?kl(e.Ie,t.Ie):e instanceof zh&&t instanceof zh}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ad extends td{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cd extends td{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function ud(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function ld(e,t,n){const i=new Map;yu(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,Bh(o,a,n[r]))}return i}function hd(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,jh(e,s,t))}return i}class dd extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fd extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class pd{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&id(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=rd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=rd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Dh();return this.mutations.forEach((i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=nd(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Mu.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Lh())}isEqual(e){return this.batchId===e.batchId&&Pu(this.mutations,e.mutations,((e,t)=>od(e,t)))&&Pu(this.baseMutations,e.baseMutations,((e,t)=>od(e,t)))}}class gd{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){yu(e.mutations.length===n.length);let i=Oh;const r=e.mutations;for(let e=0;e<r.length;e++)i=i.insert(r[e].key,n[e].version);return new gd(e,t,n,i)}}class md{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var yd,vd;(vd=yd||(yd={}))[vd.OK=0]="OK",vd[vd.CANCELLED=1]="CANCELLED",vd[vd.UNKNOWN=2]="UNKNOWN",vd[vd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vd[vd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vd[vd.NOT_FOUND=5]="NOT_FOUND",vd[vd.ALREADY_EXISTS=6]="ALREADY_EXISTS",vd[vd.PERMISSION_DENIED=7]="PERMISSION_DENIED",vd[vd.UNAUTHENTICATED=16]="UNAUTHENTICATED",vd[vd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vd[vd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vd[vd.ABORTED=10]="ABORTED",vd[vd.OUT_OF_RANGE=11]="OUT_OF_RANGE",vd[vd.UNIMPLEMENTED=12]="UNIMPLEMENTED",vd[vd.INTERNAL=13]="INTERNAL",vd[vd.UNAVAILABLE=14]="UNAVAILABLE",vd[vd.DATA_LOSS=15]="DATA_LOSS",new ou([4294967295,4294967295],0),Error;class wd{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bd(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Id(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ed(e,t){return bd(e,t.toTimestamp())}function _d(e){return yu(!!e),Mu.fromTimestamp(function(e){const t=vl(e);return new Lu(t.seconds,t.nanos)}(e))}function Td(e,t){return Sd(e,t).canonicalString()}function Sd(e,t){const n=function(e){return new Uu(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Cd(e,t){return Td(e.databaseId,t.path)}function Ad(e){const t=function(e){const t=Uu.fromString(e);return yu(function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}(t)),t}(e);return 4===t.length?Uu.emptyPath():function(e){return yu(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}(t)}function kd(e,t,n){return{name:Cd(e,t),fields:n.value.mapValue.fields}}function Nd(e){let t=Ad(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){yu(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Dd(e);return t instanceof Ql&&Xl(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Hl(Rd(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,rl(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new $l(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new $l(n,t)}(n.endAt)),function(e,t,n,i,r,s,o,a){return new fh(e,t,n,i,r,s,o,a)}(t,r,o,s,a,"F",c,u)}function Dd(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Rd(e.unaryFilter.field);return Wl.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Rd(e.unaryFilter.field);return Wl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Rd(e.unaryFilter.field);return Wl.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Rd(e.unaryFilter.field);return Wl.create(r,"!=",{nullValue:"NULL_VALUE"});default:return mu()}}(e):void 0!==e.fieldFilter?function(e){return Wl.create(Rd(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mu()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ql.create(e.compositeFilter.filters.map((e=>Dd(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return mu()}}(e.compositeFilter.op))}(e):mu()}function Rd(e){return Vu.fromServerFormat(e.fieldPath)}function Od(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}class Pd{constructor(e){this.ct=e}}function Ld(e){const t=Nd({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?yh(t,t.limit,"L"):t}class Md{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(wl(e.integerValue));else if("doubleValue"in e){const n=wl(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),sl(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(bl(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Fl(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):mu()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),ju.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}Md.bt=new Md;class xd{constructor(){this._n=new Ud}addToCollectionParentIndex(e,t){return this._n.add(t),Gu.resolve()}getCollectionParents(e,t){return Gu.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return Gu.resolve()}deleteFieldIndex(e,t){return Gu.resolve()}deleteAllFieldIndexes(e){return Gu.resolve()}createTargetIndexes(e,t){return Gu.resolve()}getDocumentsMatchingTarget(e,t){return Gu.resolve(null)}getIndexType(e,t){return Gu.resolve(0)}getFieldIndexes(e,t){return Gu.resolve([])}getNextCollectionGroupToUpdate(e){return Gu.resolve(null)}getMinOffset(e,t){return Gu.resolve($u.min())}getMinOffsetFromCollectionGroup(e,t){return Gu.resolve($u.min())}updateCollectionGroup(e,t,n){return Gu.resolve()}updateIndexEntries(e,t){return Gu.resolve()}}class Ud{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new dl(Uu.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new dl(Uu.comparator)).toArray()}}new Uint8Array(0);class Fd{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Fd(e,Fd.DEFAULT_COLLECTION_PERCENTILE,Fd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Fd.DEFAULT_COLLECTION_PERCENTILE=10,Fd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fd.DEFAULT=new Fd(41943040,Fd.DEFAULT_COLLECTION_PERCENTILE,Fd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fd.DISABLED=new Fd(-1,0,0);class Vd{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Vd(0)}static Bn(){return new Vd(-1)}}class jd{constructor(){this.changes=new _h((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bl.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Gu.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Bd{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class $d{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&rd(n.mutation,e,pl.empty(),Lu.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Lh()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Lh()){const i=Nh();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=Ah();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Nh();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Lh())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=Sh();const s=Rh(),o=Rh();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof cd)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),rd(o.mutation,t,o.mutation.getFieldMask(),Lu.now())):s.set(t.key,pl.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Bd(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Rh();let i=new ul(((e,t)=>e-t)),r=Lh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||pl.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||Lh()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=Dh();c.forEach((e=>{if(!r.has(e)){const i=nd(t.get(e),n.get(e));null!==i&&u.set(e,i),r=r.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Gu.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,i){return function(e){return ju.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):Gu.resolve(Nh());let o=-1,a=r;return s.next((t=>Gu.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?Gu.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,Lh()))).next((e=>({batchId:o,changes:kh(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ju(t)).next((e=>{let t=Ah();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let s=Ah();return this.indexManager.getCollectionParents(e,r).next((o=>Gu.forEach(o,(o=>{const a=function(e,t){return new fh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(r));return this.getDocumentsMatchingCollectionQuery(e,a,n,i).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i)))).next((e=>{r.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,Bl.newInvalidDocument(i)))}));let n=Ah();return e.forEach(((e,i)=>{const s=r.get(e);void 0!==s&&rd(s.mutation,i,pl.empty(),Lu.now()),Ih(t,i)&&(n=n.insert(e,i))})),n}))}}class zd{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return Gu.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:_d(e.createTime)}}(t)),Gu.resolve()}getNamedQuery(e,t){return Gu.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Ld(e.bundledQuery),readTime:_d(e.readTime)}}(t)),Gu.resolve()}}class qd{constructor(){this.overlays=new ul(ju.comparator),this.hr=new Map}getOverlay(e,t){return Gu.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Nh();return Gu.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ht(e,t,i)})),Gu.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),Gu.resolve()}getOverlaysForCollection(e,t,n){const i=Nh(),r=t.length+1,s=new ju(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return Gu.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new ul(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=Nh(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Nh(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return Gu.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new md(t,n));let r=this.hr.get(t);void 0===r&&(r=Lh(),this.hr.set(t,r)),this.hr.set(t,r.add(n.key))}}class Hd{constructor(){this.Pr=new dl(Kd.Ir),this.Tr=new dl(Kd.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new Kd(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new Kd(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new ju(new Uu([])),n=new Kd(t,e),i=new Kd(t,e+1),r=[];return this.Tr.forEachInRange([n,i],(e=>{this.Ar(e),r.push(e.key)})),r}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new ju(new Uu([])),n=new Kd(t,e),i=new Kd(t,e+1);let r=Lh();return this.Tr.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new Kd(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Kd{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return ju.comparator(e.key,t.key)||Ou(e.pr,t.pr)}static Er(e,t){return Ou(e.pr,t.pr)||ju.comparator(e.key,t.key)}}class Gd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new dl(Kd.Ir)}checkEmpty(e){return Gu.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new pd(r,t,n,i);this.mutationQueue.push(s);for(const t of i)this.wr=this.wr.add(new Kd(t.key,r)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Gu.resolve(s)}lookupMutationBatch(e,t){return Gu.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.br(n),r=i<0?0:i;return Gu.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Gu.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return Gu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Kd(t,0),i=new Kd(t,Number.POSITIVE_INFINITY),r=[];return this.wr.forEachInRange([n,i],(e=>{const t=this.Sr(e.pr);r.push(t)})),Gu.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new dl(Ou);return t.forEach((e=>{const t=new Kd(e,0),i=new Kd(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,i],(e=>{n=n.add(e.pr)}))})),Gu.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;ju.isDocumentKey(r)||(r=r.child(""));const s=new Kd(new ju(r),0);let o=new dl(Ou);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.pr)),!0)}),s),Gu.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){yu(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Gu.forEach(t.mutations,(i=>{const r=new Kd(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new Kd(t,0),i=this.wr.firstAfterOrEqual(n);return Gu.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Gu.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Wd{constructor(e){this.vr=e,this.docs=new ul(ju.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Gu.resolve(n?n.document.mutableCopy():Bl.newInvalidDocument(t))}getEntries(e,t){let n=Sh();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Bl.newInvalidDocument(e))})),Gu.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Sh();const s=t.path,o=new ju(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||zu(Bu(o),n)<=0||(i.has(o.key)||Ih(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Gu.resolve(r)}getAllFromCollectionGroup(e,t,n,i){mu()}Fr(e,t){return Gu.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Qd(this)}getSize(e){return Gu.resolve(this.size)}}class Qd extends jd{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(n)})),Gu.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class Jd{constructor(e){this.persistence=e,this.Mr=new _h((e=>hh(e)),dh),this.lastRemoteSnapshotVersion=Mu.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Hd,this.targetCount=0,this.Br=Vd.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),Gu.resolve()}getLastRemoteSnapshotVersion(e){return Gu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Gu.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),Gu.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),Gu.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Br=new Vd(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,Gu.resolve()}updateTargetData(e,t){return this.qn(t),Gu.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,Gu.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),Gu.waitFor(r).next((()=>i))}getTargetCount(e){return Gu.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return Gu.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),Gu.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),Gu.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),Gu.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return Gu.resolve(n)}containsKey(e,t){return Gu.resolve(this.Nr.containsKey(t))}}class Xd{constructor(e,t){this.Lr={},this.overlays={},this.kr=new il(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Jd(this),this.indexManager=new xd,this.remoteDocumentCache=function(e){return new Wd(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Pd(t),this.$r=new zd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Lr[e.toKey()];return n||(n=new Gd(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){du("MemoryPersistence","Starting transaction:",e);const i=new Yd(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((e=>this.referenceDelegate.Wr(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Gr(e,t){return Gu.or(Object.values(this.Lr).map((n=>()=>n.containsKey(e,t))))}}class Yd extends Hu{constructor(e){super(),this.currentSequenceNumber=e}}class Zd{constructor(e){this.persistence=e,this.zr=new Hd,this.jr=null}static Hr(e){return new Zd(e)}get Jr(){if(this.jr)return this.jr;throw mu()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),Gu.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),Gu.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),Gu.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gu.forEach(this.Jr,(n=>{const i=ju.fromPath(n);return this.Yr(e,i).next((e=>{e||t.removeEntry(i,Mu.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return Gu.or([()=>Gu.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class ef{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=i}static Ki(e,t){let n=Lh(),i=Lh();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new ef(e,t.fromCache,n,i)}}class tf{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class nf{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var e;const t=null===(e=o())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Qu.v(h())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.ji(e,t).next((e=>{r.result=e})).next((()=>{if(!r.result)return this.Hi(e,t,i,n).next((e=>{r.result=e}))})).next((()=>{if(r.result)return;const n=new tf;return this.Ji(e,t,n).next((i=>{if(r.result=i,this.Ui)return this.Yi(e,t,n,i.size)}))})).next((()=>r.result))}Yi(e,t,n,i){return n.documentReadCount<this.Wi?(hu()<=x.DEBUG&&du("QueryEngine","SDK will not create cache indexes for query:",bh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Gu.resolve()):(hu()<=x.DEBUG&&du("QueryEngine","Query:",bh(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(hu()<=x.DEBUG&&du("QueryEngine","The SDK decides to create cache indexes for query:",bh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mh(t))):Gu.resolve())}ji(e,t){if(ph(t))return Gu.resolve(null);let n=mh(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=yh(t,null,"F"),n=mh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=Lh(...i);return this.zi.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Zi(t,i);return this.Xi(t,s,r,n.readTime)?this.ji(e,yh(t,null,"F")):this.es(e,s,t,n)}))))})))))}Hi(e,t,n,i){return ph(t)||i.isEqual(Mu.min())?Gu.resolve(null):this.zi.getDocuments(e,n).next((r=>{const s=this.Zi(t,r);return this.Xi(t,s,n,i)?Gu.resolve(null):(hu()<=x.DEBUG&&du("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bh(t)),this.es(e,s,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Mu.fromTimestamp(1e9===i?new Lu(n+1,0):new Lu(n,i));return new $u(r,ju.empty(),t)}(i,-1)).next((e=>e)))}))}Zi(e,t){let n=new dl(function(e){return(t,n)=>{let i=!1;for(const r of gh(e)){const e=Eh(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}(e));return t.forEach(((t,i)=>{Ih(e,i)&&(n=n.add(i))})),n}Xi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ji(e,t,n){return hu()<=x.DEBUG&&du("QueryEngine","Using full collection scan to execute query:",bh(t)),this.zi.getDocumentsMatchingQuery(e,t,$u.min(),n)}es(e,t,n,i){return this.zi.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class rf{constructor(e,t,n,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new ul(Ou),this.rs=new _h((e=>hh(e)),dh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $d(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}async function sf(e,t){const n=vu(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],s=[];let o=Lh();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:r,addedBatchIds:s})))}))}))}function of(e,t){const n=vu(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}class af{constructor(){this.activeTargetIds=Mh}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cf{constructor(){this.no=new af,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new af,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class uf{io(e){}shutdown(){}}class lf{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){du("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){du("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let hf=null;function df(){return null===hf?hf=268435456+Math.round(2147483648*Math.random()):hf++,"0x"+hf.toString(16)}const ff={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pf{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const gf="WebChannelConnection";class mf extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(e,t,n,i,r){const s=df(),o=this.bo(e,t.toUriEncodedString());du("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,r),this.Co(e,o,a,n).then((t=>(du("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw pu("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,i,r,s){return this.So(e,t,n,i,r)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+uu,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=ff[e];return`${this.fo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,i){const r=df();return new Promise(((s,o)=>{const a=new su;a.setWithCredentials(!0),a.listenOnce(tu.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case eu.NO_ERROR:const t=a.getResponseJson();du(gf,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),s(t);break;case eu.TIMEOUT:du(gf,`RPC '${e}' ${r} timed out`),o(new bu(wu.DEADLINE_EXCEEDED,"Request time out"));break;case eu.HTTP_ERROR:const n=a.getStatus();if(du(gf,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(wu).indexOf(t)>=0?t:wu.UNKNOWN}(t.status);o(new bu(e,t.message))}else o(new bu(wu.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new bu(wu.UNAVAILABLE,"Connection failed."));break;default:mu()}}finally{du(gf,`RPC '${e}' ${r} completed.`)}}));const c=JSON.stringify(i);du(gf,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",c,n,15)}))}Fo(e,t,n){const i=df(),r=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Yc(),o=Zc(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=r.join("");du(gf,`Creating RPC '${e}' stream ${i}: ${u}`,a);const l=s.createWebChannel(u,a);let h=!1,d=!1;const f=new pf({lo:t=>{d?du(gf,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(du(gf,`Opening RPC '${e}' stream ${i} transport.`),l.open(),h=!0),du(gf,`RPC '${e}' stream ${i} sending:`,t),l.send(t))},ho:()=>l.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(l,ru.EventType.OPEN,(()=>{d||du(gf,`RPC '${e}' stream ${i} transport opened.`)})),p(l,ru.EventType.CLOSE,(()=>{d||(d=!0,du(gf,`RPC '${e}' stream ${i} transport closed`),f.Vo())})),p(l,ru.EventType.ERROR,(t=>{d||(d=!0,pu(gf,`RPC '${e}' stream ${i} transport errored:`,t),f.Vo(new bu(wu.UNAVAILABLE,"The operation could not be completed")))})),p(l,ru.EventType.MESSAGE,(t=>{var n;if(!d){const r=t.data[0];yu(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){du(gf,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=yd[e];if(void 0!==t)return function(e){if(void 0===e)return fu("GRPC error has no .code"),wu.UNKNOWN;switch(e){case yd.OK:return wu.OK;case yd.CANCELLED:return wu.CANCELLED;case yd.UNKNOWN:return wu.UNKNOWN;case yd.DEADLINE_EXCEEDED:return wu.DEADLINE_EXCEEDED;case yd.RESOURCE_EXHAUSTED:return wu.RESOURCE_EXHAUSTED;case yd.INTERNAL:return wu.INTERNAL;case yd.UNAVAILABLE:return wu.UNAVAILABLE;case yd.UNAUTHENTICATED:return wu.UNAUTHENTICATED;case yd.INVALID_ARGUMENT:return wu.INVALID_ARGUMENT;case yd.NOT_FOUND:return wu.NOT_FOUND;case yd.ALREADY_EXISTS:return wu.ALREADY_EXISTS;case yd.PERMISSION_DENIED:return wu.PERMISSION_DENIED;case yd.FAILED_PRECONDITION:return wu.FAILED_PRECONDITION;case yd.ABORTED:return wu.ABORTED;case yd.OUT_OF_RANGE:return wu.OUT_OF_RANGE;case yd.UNIMPLEMENTED:return wu.UNIMPLEMENTED;case yd.DATA_LOSS:return wu.DATA_LOSS;default:return mu()}}(t)}(t),r=o.message;void 0===n&&(n=wu.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.Vo(new bu(n,r)),l.close()}else du(gf,`RPC '${e}' stream ${i} received:`,r),f.mo(r)}})),p(o,nu.STAT_EVENT,(t=>{t.stat===iu.PROXY?du(gf,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===iu.NOPROXY&&du(gf,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function yf(){return"undefined"!=typeof document?document:null}function vf(e){return new wd(e,!0)}class wf{constructor(e,t,n=1e3,i=1.5,r=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=i,this.Oo=r,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,t-n);i>0&&du("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class bf{constructor(e,t,n,i,r,s,o,a){this.oi=e,this.$o=n,this.Uo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new wf(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===wu.RESOURCE_EXHAUSTED?(fu(t.toString()),fu("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===wu.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Wo===t&&this.o_(e,n)}),(t=>{e((()=>{const e=new bu(wu.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return du("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(du("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class If extends bf{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(yu(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(yu(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?_d(e.updateTime):_d(t);return n.isEqual(Mu.min())&&(n=_d(t)),new Yh(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=_d(e.commitTime);return this.listener.T_(n,t)}return yu(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=function(e){return new Uu(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof ad)n={update:kd(e,t.key,t.value)};else if(t instanceof dd)n={delete:Cd(e,t.key)};else if(t instanceof cd)n={update:kd(e,t.key,t.data),updateMask:Od(t.fieldMask)};else{if(!(t instanceof fd))return mu();n={verify:Cd(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof zh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Kh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Wh)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw mu()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ed(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:mu()}(e,t.precondition)),n}(this.serializer,e)))};this.t_(t)}}class Ef extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new bu(wu.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.So(e,Sd(t,n),i,r,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===wu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new bu(wu.UNKNOWN,e.toString())}))}vo(e,t,n,i,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(e,Sd(t,n),i,s,o,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===wu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new bu(wu.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class _f{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(fu(t),this.g_=!1):du("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Tf{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=r,this.M_.io((e=>{n.enqueueAndForget((async()=>{Af(this)&&(du("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=vu(e);t.v_.add(4),await Cf(t),t.x_.set("Unknown"),t.v_.delete(4),await Sf(t)}(this))}))})),this.x_=new _f(n,i)}}async function Sf(e){if(Af(e))for(const t of e.F_)await t(!0)}async function Cf(e){for(const t of e.F_)await t(!1)}function Af(e){return 0===vu(e).v_.size}async function kf(e,t,n){if(!Yu(t))throw t;e.v_.add(1),await Cf(e),e.x_.set("Offline"),n||(n=()=>function(e){const t=vu(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{du("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await Sf(e)}))}function Nf(e,t){return t().catch((n=>kf(e,n,t)))}async function Df(e){const t=vu(e),n=jf(t);let i=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;Rf(t);)try{const e=await of(t.localStore,i);if(null===e){0===t.D_.length&&n.Xo();break}i=e.batchId,Of(t,e)}catch(e){await kf(t,e)}Pf(t)&&Lf(t)}function Rf(e){return Af(e)&&e.D_.length<10}function Of(e,t){e.D_.push(t);const n=jf(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Pf(e){return Af(e)&&!jf(e).Ho()&&e.D_.length>0}function Lf(e){jf(e).start()}async function Mf(e){jf(e).d_()}async function xf(e){const t=jf(e);for(const n of e.D_)t.I_(n.mutations)}async function Uf(e,t,n){const i=e.D_.shift(),r=gd.from(i,t,n);await Nf(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await Df(e)}async function Ff(e,t){t&&jf(e).P_&&await async function(e,t){if(function(e){return function(e){switch(e){default:return mu();case wu.CANCELLED:case wu.UNKNOWN:case wu.DEADLINE_EXCEEDED:case wu.RESOURCE_EXHAUSTED:case wu.INTERNAL:case wu.UNAVAILABLE:case wu.UNAUTHENTICATED:return!1;case wu.INVALID_ARGUMENT:case wu.NOT_FOUND:case wu.ALREADY_EXISTS:case wu.PERMISSION_DENIED:case wu.FAILED_PRECONDITION:case wu.ABORTED:case wu.OUT_OF_RANGE:case wu.UNIMPLEMENTED:case wu.DATA_LOSS:return!0}}(e)&&e!==wu.ABORTED}(t.code)){const n=e.D_.shift();jf(e).Zo(),await Nf(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Df(e)}}(e,t),Pf(e)&&Lf(e)}async function Vf(e,t){const n=vu(e);n.asyncQueue.verifyOperationInProgress(),du("RemoteStore","RemoteStore received new credentials");const i=Af(n);n.v_.add(3),await Cf(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await Sf(n)}function jf(e){return e.B_||(e.B_=function(e,t,n){const i=vu(e);return i.R_(),new If(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Po:Mf.bind(null,e),To:Ff.bind(null,e),E_:xf.bind(null,e),T_:Uf.bind(null,e)}),e.F_.push((async t=>{t?(e.B_.Zo(),await Df(e)):(await e.B_.stop(),e.D_.length>0&&(du("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.B_}class Bf{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Iu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new Bf(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bu(wu.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $f(e,t){if(fu("AsyncQueue",`${t}: ${e}`),Yu(e))return new bu(wu.UNAVAILABLE,`${t}: ${e}`);throw e}class zf{constructor(){this.queries=new _h((e=>wh(e)),vh),this.onlineState="Unknown",this.K_=new Set}}class qf{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new _h((e=>wh(e)),vh),this.pa=new Map,this.ya=new Set,this.wa=new ul(ju.comparator),this.Sa=new Map,this.ba=new Hd,this.Da={},this.Ca=new Map,this.va=Vd.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}function Hf(e,t,n){const i=vu(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.ga.forEach(((n,i)=>{const r=i.view.U_(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=vu(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.Q_)e.U_(t)&&(i=!0)})),i&&function(e){e.K_.forEach((e=>{e.next()}))}(n)}(i.eventManager,t),e.length&&i.fa.u_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Kf(e,t){const n=vu(e),i=t.batch.batchId;try{const e=await function(e,t){const n=vu(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=Gu.resolve();return s.forEach((e=>{o=o.next((()=>i.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);yu(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Lh();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);Qf(n,i,null),Wf(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Jf(n,e)}catch(e){await Ku(e)}}async function Gf(e,t,n){const i=vu(e);try{const e=await function(e,t){const n=vu(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(yu(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);Qf(i,t,n),Wf(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await Jf(i,e)}catch(n){await Ku(n)}}function Wf(e,t){(e.Ca.get(t)||[]).forEach((e=>{e.resolve()})),e.Ca.delete(t)}function Qf(e,t,n){const i=vu(e);let r=i.Da[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Da[i.currentUser.toKey()]=r}}async function Jf(e,t,n){const i=vu(e),r=[],s=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((e,a)=>{o.push(i.Ma(a,t,n).then((e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){r.push(e);const t=ef.Ki(a.targetId,e);s.push(t)}})))})),await Promise.all(o),i.fa.u_(r),await async function(e,t){const n=vu(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Gu.forEach(t,(t=>Gu.forEach(t.qi,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>Gu.forEach(t.Qi,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!Yu(e))throw e;du("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ns.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(t,r)}}}(i.localStore,s))}async function Xf(e,t){const n=vu(e);if(!n.currentUser.isEqual(t)){du("SyncEngine","User change. New user:",t.toKey());const e=await sf(n.localStore,t);n.currentUser=t,function(e,t){e.Ca.forEach((e=>{e.forEach((e=>{e.reject(new bu(wu.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ca.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Jf(n,e.us)}}function Yf(e){const t=vu(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Kf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Gf.bind(null,t),t}class Zf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=vf(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,i){return new rf(e,t,n,i)}(this.persistence,new nf,e.initialUser,this.serializer)}createPersistence(e){return new Xd(Zd.Hr,this.serializer)}createSharedClientState(e){return new cf}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ep{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Hf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xf.bind(null,this.syncEngine),await async function(e,t){const n=vu(e);t?(n.v_.delete(2),await Sf(n)):t||(n.v_.add(2),await Cf(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new zf}createDatastore(e){const t=vf(e.databaseInfo.databaseId),n=function(e){return new mf(e)}(e.databaseInfo);return function(e,t,n,i){return new Ef(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,r){return new Tf(e,t,n,i,r)}(this.localStore,this.datastore,e.asyncQueue,(e=>Hf(this.syncEngine,e,0)),lf.D()?new lf:new uf)}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new qf(e,t,n,i,r,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=vu(e);du("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await Cf(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}class tp{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=cu.UNAUTHENTICATED,this.clientId=Ru.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{du("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(du("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new bu(wu.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Iu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=$f(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function np(e,t){e.asyncQueue.verifyOperationInProgress(),du("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await sf(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function ip(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){du("FirestoreClient","Using user provided OfflineComponentProvider");try{await np(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===wu.FAILED_PRECONDITION||e.code===wu.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;pu("Error using user provided cache. Falling back to memory cache: "+n),await np(e,new Zf)}}else du("FirestoreClient","Using default OfflineComponentProvider"),await np(e,new Zf);return e._offlineComponents}(e);du("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Vf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Vf(t.remoteStore,n))),e._onlineComponents=t}function rp(e){return async function(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(du("FirestoreClient","Using user provided OnlineComponentProvider"),await ip(e,e._uninitializedComponentsProvider._online)):(du("FirestoreClient","Using default OnlineComponentProvider"),await ip(e,new ep))),e._onlineComponents}(e).then((e=>e.syncEngine))}function sp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const op=new Map;function ap(e){if(!ju.isDocumentKey(e))throw new bu(wu.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function cp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":mu()}function up(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new bu(wu.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cp(e);throw new bu(wu.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class lp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new bu(wu.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new bu(wu.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new bu(wu.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new bu(wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new bu(wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new bu(wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hp{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new bu(wu.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new bu(wu.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new _u;switch(e.type){case"firstParty":return new Au(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new bu(wu.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=op.get(e);t&&(du("ComponentProvider","Removing Datastore"),op.delete(e),t.terminate())}(this),Promise.resolve()}}class dp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dp(this.firestore,e,this._query)}}class fp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fp(this.firestore,e,this._key)}}class pp extends dp{constructor(e,t,n){super(e,t,function(e){return new fh(e)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fp(this.firestore,null,new ju(e))}withConverter(e){return new pp(this.firestore,e,this._path)}}function gp(e,t,...n){if(e=D(e),1===arguments.length&&(t=Ru.newId()),function(e,t,n){if(!n)throw new bu(wu.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}("doc","path",t),e instanceof hp){const i=Uu.fromString(t,...n);return ap(i),new fp(e,null,new ju(i))}{if(!(e instanceof fp||e instanceof pp))throw new bu(wu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Uu.fromString(t,...n));return ap(i),new fp(e.firestore,e instanceof pp?e.converter:null,new ju(i))}}class mp{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new wf(this,"async_queue_retry"),this._u=()=>{const e=yf();e&&du("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=yf();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;const t=yf();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise((()=>{}));const t=new Iu;return this.uu((()=>this.tu&&this.su?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.eu.push(e),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!Yu(e))throw e;du("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(e){const t=this.Xa.then((()=>(this.iu=!0,e().catch((e=>{this.ru=e,this.iu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw fu("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.iu=!1,e))))));return this.Xa=t,t}enqueueAfterDelay(e,t,n){this.au(),this.ou.indexOf(e)>-1&&(t=0);const i=Bf.createAndSchedule(this,e,t,n,(e=>this.lu(e)));return this.nu.push(i),i}au(){this.ru&&mu()}verifyOperationInProgress(){}async hu(){let e;do{e=this.Xa,await e}while(e!==this.Xa)}Pu(e){for(const t of this.nu)if(t.timerId===e)return!0;return!1}Iu(e){return this.hu().then((()=>{this.nu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.nu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.hu()}))}Tu(e){this.ou.push(e)}lu(e){const t=this.nu.indexOf(e);this.nu.splice(t,1)}}class yp extends hp{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new mp,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||vp(this),this._firestoreClient.terminate()}}function vp(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new Tl(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,sp(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new tp(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class wp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wp(ml.fromBase64String(e))}catch(e){throw new bu(wu.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new wp(ml.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class bp{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new bu(wu.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vu(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ip{constructor(e){this._methodName=e}}class Ep{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new bu(wu.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new bu(wu.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ou(this._lat,e._lat)||Ou(this._long,e._long)}}const _p=/^__.*__$/;class Tp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new cd(e,this.data,this.fieldMask,t,this.fieldTransforms):new ad(e,this.data,t,this.fieldTransforms)}}class Sp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new cd(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mu()}}class Ap{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new Ap(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Au({path:n,Vu:!1});return i.mu(e),i}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return jp(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(0===e.length)throw this.pu("Document fields must not be empty");if(Cp(this.du)&&_p.test(e))throw this.pu('Document fields cannot begin and end with "__"')}}class kp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vf(e)}Su(e,t,n,i=!1){return new Ap({du:e,methodName:t,wu:n,path:Vu.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Np(e){const t=e._freezeSettings(),n=vf(e._databaseId);return new kp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Dp(e,t,n,i,r,s={}){const o=e.Su(s.merge||s.mergeFields?2:0,t,n,r);xp("Data must be an object, but it was:",o,i);const a=Lp(i,o);let c,u;if(s.merge)c=new pl(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Up(t,i,n);if(!o.contains(r))throw new bu(wu.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Bp(e,r)||e.push(r)}c=new pl(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Tp(new Vl(a),c,u)}class Rp extends Ip{_toFieldTransform(e){if(2!==e.du)throw 1===e.du?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rp}}class Op extends Ip{constructor(e,t){super(e),this.bu=t}_toFieldTransform(e){const t=function(e,t,n){return new Ap({du:3,wu:t.settings.wu,methodName:e._methodName,Vu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}(this,e,!0),n=this.bu.map((e=>Pp(e,t))),i=new qh(n);return new Xh(e.path,i)}isEqual(e){return e instanceof Op&&v(this.bu,e.bu)}}function Pp(e,t){if(Mp(e=D(e)))return xp("Unsupported field value:",t,e),Lp(e,t);if(e instanceof Ip)return function(e,t){if(!Cp(t.du))throw t.pu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.pu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Vu&&4!==t.du)throw t.pu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=Pp(r,t.gu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=D(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Fh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Lu.fromDate(e);return{timestampValue:bd(t.serializer,n)}}if(e instanceof Lu){const n=new Lu(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:bd(t.serializer,n)}}if(e instanceof Ep)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof wp)return{bytesValue:Id(t.serializer,e._byteString)};if(e instanceof fp){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Td(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.pu(`Unsupported field value: ${cp(e)}`)}(e,t)}function Lp(e,t){const n={};return cl(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):al(e,((e,i)=>{const r=Pp(i,t.Ru(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function Mp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Lu||e instanceof Ep||e instanceof wp||e instanceof fp||e instanceof Ip)}function xp(e,t,n){if(!Mp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=cp(n);throw"an object"===i?t.pu(e+" a custom object"):t.pu(e+" "+i)}}function Up(e,t,n){if((t=D(t))instanceof bp)return t._internalPath;if("string"==typeof t)return Vp(e,t);throw jp("Field path arguments must be of type string or ",e,!1,void 0,n)}const Fp=new RegExp("[~\\*/\\[\\]]");function Vp(e,t,n){if(t.search(Fp)>=0)throw jp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new bp(...t.split("."))._internalPath}catch(i){throw jp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function jp(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new bu(wu.INVALID_ARGUMENT,a+e+c)}function Bp(e,t){return e.some((e=>e.isEqual(t)))}function $p(e,t){return function(e,t){const n=new Iu;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=Yf(e);try{const e=await function(e,t){const n=vu(e),i=Lu.now(),r=t.reduce(((e,t)=>e.add(t.key)),Lh());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Sh(),c=Lh();return n.os.getEntries(e,r).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((r=>{s=r;const o=[];for(const e of t){const t=sd(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new cd(e.key,t,jl(t.value.mapValue),Zh.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)})).next((t=>{o=t;const i=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:kh(s)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Da[e.currentUser.toKey()];i||(i=new ul(Ou)),i=i.insert(t,n),e.Da[e.currentUser.toKey()]=i}(i,e.batchId,n),await Jf(i,e.changes),await Df(i.remoteStore)}catch(e){const t=$f(e,"Failed to persist write");n.reject(t)}}(await rp(e),t,n))),n.promise}(function(e){return e._firestoreClient||vp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(e),t)}function zp(...e){return new Op("arrayUnion",e)}new WeakMap,function(e,t=!0){!function(e){uu=e}(we),ge(new R("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new yp(new Su(e.getProvider("auth-internal")),new Nu(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new bu(wu.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sl(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Ee(au,"4.4.3",e),Ee(au,"4.4.3","esm2017")}();var qp=be({apiKey:"AIzaSyBpI0Dfq56oUexIsDu8Jn3yya5TyTcVL94",authDomain:"mucproject-070723.firebaseapp.com",projectId:"mucproject-070723",storageBucket:"mucproject-070723.appspot.com",messagingSenderId:"330836170033",appId:"1:330836170033:web:5dbc537644c8ea6ce04c10",measurementId:"G-NK595W90GJ"}),Hp=function(e=Ie()){const t=me(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=me(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(v(n.getOptions(),null!=t?t:{}))return e;nn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:xr,persistence:[tr,Fi,ji]}),i=u("authTokenSyncURL");if(i){const e=(r=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>jr)return;const i=null==t?void 0:t.token;Br!==i&&(Br=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){D(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,i,r){D(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var r;const s=a("auth");return s&&function(e,t,n){const i=ni(e);on(i._canInitEmulator,i,"emulator-config-failed"),on(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=li(t),{host:o,port:a}=function(e){const t=li(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:hi(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:hi(t)}}}(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}(qp),Kp=(function(e=Ie()){const t=me(e=D(e),It);t.isInitialized()?t.getImmediate():function(e,t={}){const n=me(e,It);if(n.isInitialized()){const e=n.getImmediate();if(v(t,n.getOptions()))return e;throw kt.create("already-initialized")}n.initialize({options:t})}(e)}(qp),function(e,t){const n="string"==typeof e?e:"(default)",i=me("object"==typeof e?e:Ie(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=(e=>{const t=a("firestore");if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})();e&&function(e,t,n,i={}){var s;const o=(e=up(e,hp))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&pu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=cu.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new bu(wu.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new cu(o)}e._authCredentials=new Tu(new Eu(t,n))}}(i,...e)}return i}(qp));function Gp(e,t){(function(e,t,n,...i){e=up(e,fp);const r=up(e.firestore,yp),s=Np(r);let o;return o="string"==typeof(t=D(t))||t instanceof bp?function(e,t,n,i,r,s){const o=e.Su(1,t,n),a=[Up(t,i,n)],c=[r];if(s.length%2!=0)throw new bu(wu.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(Up(t,s[e])),c.push(s[e+1]);const u=[],l=Vl.empty();for(let e=a.length-1;e>=0;--e)if(!Bp(u,a[e])){const t=a[e];let n=c[e];n=D(n);const i=o.fu(t);if(n instanceof Rp)u.push(t);else{const e=Pp(n,i);null!=e&&(u.push(t),l.set(t,e))}}const h=new pl(u);return new Sp(l,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,i):function(e,t,n,i){const r=e.Su(1,t,n);xp("Data must be an object, but it was:",r,i);const s=[],o=Vl.empty();al(i,((e,i)=>{const a=Vp(t,e,n);i=D(i);const c=r.fu(a);if(i instanceof Rp)s.push(a);else{const e=Pp(i,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new pl(s);return new Sp(o,a,r.fieldTransforms)}(s,"updateDoc",e._key,t),$p(r,[o.toMutation(e._key,Zh.exists(!0))])})(gp(Kp,"users",e),{friends:zp(t)}).then((function(){console.log("Amigo aadido correctamente.")})).catch((function(e){console.error("Error al aadir amigo: ",e)}))}document.querySelector(".register form")&&document.querySelector(".register form").addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("newMail").value,n=document.getElementById("newPassword").value,i=document.getElementById("confirmP").value,r=document.getElementById("newUsername").value;n===i?async function(e,t,n){const i=ni(e),r=ui(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ki),s=await r.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Li(e),t})),o=await Ni._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(o.user),o}(Hp,t,n).then((function(e){console.log("Usuario registrado exitosamente:",e.user),function(e,t){e.updateProfile({displayName:t}).then((function(){console.log("Perfil del usuario actualizado con el nombre de usuario:",t)})).catch((function(e){console.error("Error al actualizar el perfil del usuario:",e)}))}(e.user,r),function(e,t,n){e=up(e,fp);const i=up(e.firestore,yp),r=function(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}(e.converter,t,n);return $p(i,[Dp(Np(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Zh.none())])}(gp(Kp,"users",e.user.uid),{username:r,friends:[]}).then((function(){console.log("Documento del usuario creado con xito en Firestore")})).catch((function(e){console.error("Error al crear el documento del usuario en Firestore:",e)})),window.location.href="main.html"})).catch((function(e){console.error("Error al registrar el usuario:",e),alert("El usuario ya registrado")})):alert("Contraseas no iguales")})),document.querySelector(".login form")&&document.querySelector(".login form").addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("mail").value,n=document.getElementById("password").value;(function(e,t,n){return async function(e,t){return Pi(ni(e),t)}(D(e),Ii.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Li(e),t}))})(Hp,t,n).then((function(e){console.log("Usuario conectado exitosamente:",e.user),window.location.href="main.html"})).catch((function(e){console.error("Revisa tus datos",e),alert("Las credenciales son incorrectas o el usuario no existe.")}))})),document.addEventListener("DOMContentLoaded",(function(){console.log("DOM cargado y listo para usar."),console.log(document.getElementById("culiao")),document.getElementById("addFriendButton").addEventListener("click",(function(){console.log("Por favor, introduce un nombre de usuario.");var e,t=document.getElementById("addFriend").value;t?(e=t,Kp.collection("users").where("username","==",e).get().then((function(e){return e.empty?(console.log("Usuario no encontrado"),null):e.docs[0].id})).catch((function(e){return console.error("Error al buscar usuario:",e),null}))).then((function(e){e?Gp(Hp.currentUser.uid,e):console.log("Usuario no encontrado.")})):console.log("Por favor, introduce un nombre de usuario.")}))}))})()})();